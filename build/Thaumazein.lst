ARM GAS  /var/folders/9s/8rp0_f2s1n31qbztm3b5_fdh0000gn/T//cckLE3ug.s 			page 1


   1              		.cpu cortex-m7
   2              		.arch armv7e-m
   3              		.fpu fpv5-d16
   4              		.eabi_attribute 28, 1
   5              		.eabi_attribute 20, 1
   6              		.eabi_attribute 21, 1
   7              		.eabi_attribute 23, 3
   8              		.eabi_attribute 24, 1
   9              		.eabi_attribute 25, 1
  10              		.eabi_attribute 26, 1
  11              		.eabi_attribute 30, 4
  12              		.eabi_attribute 34, 1
  13              		.eabi_attribute 18, 4
  14              		.file	"Thaumazein.cpp"
  15              		.text
  16              	.Ltext0:
  17              		.cfi_sections	.debug_frame
  18              		.section	.rodata._Z13UpdateDisplayv.str1.1,"aMS",%progbits,1
  19              	.LC2:
  20 0000 506F6C79 		.ascii	"Poly-4\000"
  20      2D3400
  21              	.LC3:
  22 0007 4D6F6E6F 		.ascii	"Mono\000"
  22      00
  23              	.LC4:
  24 000c 4350553A 		.ascii	"CPU: %d\000"
  24      20256400 
  25              	.LC5:
  26 0014 456E6769 		.ascii	"Engine: %d (%s)\000"
  26      6E653A20 
  26      25642028 
  26      25732900 
  27              	.LC6:
  28 0024 4C657665 		.ascii	"Level: %d%%\000"
  28      6C3A2025 
  28      64252500 
  29              	.LC7:
  30 0030 4144435B 		.ascii	"ADC[%d]: %d\000"
  30      25645D3A 
  30      20256400 
  31              	.LC8:
  32 003c 2D2D2D2D 		.ascii	"--------\000"
  32      2D2D2D2D 
  32      00
  33              		.section	.text._Z13UpdateDisplayv,"ax",%progbits
  34              		.align	1
  35              		.global	_Z13UpdateDisplayv
  36              		.syntax unified
  37              		.thumb
  38              		.thumb_func
  40              	_Z13UpdateDisplayv:
  41              	.LFB5343:
  42              		.file 1 "Thaumazein.cpp"
   1:Thaumazein.cpp **** #include "Thaumazein.h"
   2:Thaumazein.cpp **** 
   3:Thaumazein.cpp **** // Define shared volatile variables
   4:Thaumazein.cpp **** volatile uint16_t current_touch_state = 0;
ARM GAS  /var/folders/9s/8rp0_f2s1n31qbztm3b5_fdh0000gn/T//cckLE3ug.s 			page 2


   5:Thaumazein.cpp **** volatile float touch_cv_value = 0.0f;
   6:Thaumazein.cpp **** 
   7:Thaumazein.cpp **** void UpdateDisplay() {
  43              		.loc 1 7 22 view -0
  44              		.cfi_startproc
  45              		@ args = 0, pretend = 0, frame = 32
  46              		@ frame_needed = 0, uses_anonymous_args = 0
   8:Thaumazein.cpp ****     if (update_display) {
  47              		.loc 1 8 5 view .LVU1
   7:Thaumazein.cpp ****     if (update_display) {
  48              		.loc 1 7 22 is_stmt 0 view .LVU2
  49 0000 30B5     		push	{r4, r5, lr}
  50              		.cfi_def_cfa_offset 12
  51              		.cfi_offset 4, -12
  52              		.cfi_offset 5, -8
  53              		.cfi_offset 14, -4
  54              	.LBB93:
  55              		.loc 1 8 9 view .LVU3
  56 0002 314D     		ldr	r5, .L10
  57 0004 2B78     		ldrb	r3, [r5]	@ zero_extendqisi2
  58              	.LBE93:
   7:Thaumazein.cpp ****     if (update_display) {
  59              		.loc 1 7 22 view .LVU4
  60 0006 2DED028B 		vpush.64	{d8}
  61              		.cfi_def_cfa_offset 20
  62              		.cfi_offset 80, -20
  63              		.cfi_offset 81, -16
  64 000a 89B0     		sub	sp, sp, #36
  65              		.cfi_def_cfa_offset 56
  66              	.LBB94:
  67              		.loc 1 8 5 view .LVU5
  68 000c 002B     		cmp	r3, #0
  69 000e 57D0     		beq	.L1
  70              	.LBE94:
  71              	.LBB95:
  72              	.LBI95:
   7:Thaumazein.cpp ****     if (update_display) {
  73              		.loc 1 7 6 is_stmt 1 view .LVU6
  74              	.LBB96:
  75              	.LBB97:
   9:Thaumazein.cpp ****         // Get CPU Load from the CpuLoadMeter
  10:Thaumazein.cpp ****         float avg_cpu_load = cpu_meter.GetAvgCpuLoad();
  76              		.loc 1 10 9 view .LVU7
  77              	.LVL0:
  78              	.LBB98:
  79              	.LBI98:
  80              		.file 2 "lib/libdaisy/src/util/CpuLoadMeter.h"
   1:lib/libdaisy/src/util/CpuLoadMeter.h **** #pragma once
   2:lib/libdaisy/src/util/CpuLoadMeter.h **** 
   3:lib/libdaisy/src/util/CpuLoadMeter.h **** #include "sys/system.h"
   4:lib/libdaisy/src/util/CpuLoadMeter.h **** #include <cmath>
   5:lib/libdaisy/src/util/CpuLoadMeter.h **** 
   6:lib/libdaisy/src/util/CpuLoadMeter.h **** namespace daisy
   7:lib/libdaisy/src/util/CpuLoadMeter.h **** {
   8:lib/libdaisy/src/util/CpuLoadMeter.h **** /** @brief CPU load metering
   9:lib/libdaisy/src/util/CpuLoadMeter.h ****  *  @author jelliesen
  10:lib/libdaisy/src/util/CpuLoadMeter.h ****  *  @addtogroup utility
ARM GAS  /var/folders/9s/8rp0_f2s1n31qbztm3b5_fdh0000gn/T//cckLE3ug.s 			page 3


  11:lib/libdaisy/src/util/CpuLoadMeter.h ****  * 
  12:lib/libdaisy/src/util/CpuLoadMeter.h ****  *  To measure the CPU load of your audio processing, create a CpuLoadMeter
  13:lib/libdaisy/src/util/CpuLoadMeter.h ****  *  and initialize it with your block size and sample rate.
  14:lib/libdaisy/src/util/CpuLoadMeter.h ****  *  Then at the beginning of the audio callback, call `OnBlockStart()`, 
  15:lib/libdaisy/src/util/CpuLoadMeter.h ****  *  and at the end of the audio callback, call `OnBlockEnd()`.
  16:lib/libdaisy/src/util/CpuLoadMeter.h ****  *  You can then read out the minimum, maximum and average CPU load.
  17:lib/libdaisy/src/util/CpuLoadMeter.h ****  */
  18:lib/libdaisy/src/util/CpuLoadMeter.h **** class CpuLoadMeter
  19:lib/libdaisy/src/util/CpuLoadMeter.h **** {
  20:lib/libdaisy/src/util/CpuLoadMeter.h ****   public:
  21:lib/libdaisy/src/util/CpuLoadMeter.h ****     CpuLoadMeter(){};
  22:lib/libdaisy/src/util/CpuLoadMeter.h **** 
  23:lib/libdaisy/src/util/CpuLoadMeter.h ****     /** Initializes the CpuLoadMeter for a particular sample rate and block size.
  24:lib/libdaisy/src/util/CpuLoadMeter.h ****      *  @param sampleRateInHz           The sample rate in Hz
  25:lib/libdaisy/src/util/CpuLoadMeter.h ****      *  @param blockSizeInSamples       The block size in samples
  26:lib/libdaisy/src/util/CpuLoadMeter.h ****      *  @param smoothingFilterCutoffHz  The cutoff frequency of the smoothing filter that's used to
  27:lib/libdaisy/src/util/CpuLoadMeter.h ****      *                                  create the average CPU load reading.
  28:lib/libdaisy/src/util/CpuLoadMeter.h ****      */
  29:lib/libdaisy/src/util/CpuLoadMeter.h ****     void Init(float sampleRateInHz,
  30:lib/libdaisy/src/util/CpuLoadMeter.h ****               int   blockSizeInSamples,
  31:lib/libdaisy/src/util/CpuLoadMeter.h ****               float smoothingFilterCutoffHz = 1.0f)
  32:lib/libdaisy/src/util/CpuLoadMeter.h ****     {
  33:lib/libdaisy/src/util/CpuLoadMeter.h ****         const auto secPerBlock = float(blockSizeInSamples) / sampleRateInHz;
  34:lib/libdaisy/src/util/CpuLoadMeter.h ****         const auto ticksPerS   = float(System::GetTickFreq());
  35:lib/libdaisy/src/util/CpuLoadMeter.h ****         ticksPerBlockInv_      = 1.0f / (ticksPerS * secPerBlock);
  36:lib/libdaisy/src/util/CpuLoadMeter.h **** 
  37:lib/libdaisy/src/util/CpuLoadMeter.h ****         // update filter coefficient for smoothing filter (1pole lowpass)
  38:lib/libdaisy/src/util/CpuLoadMeter.h ****         const auto blockRateInHz = sampleRateInHz / float(blockSizeInSamples);
  39:lib/libdaisy/src/util/CpuLoadMeter.h ****         const auto cutoffNormalized
  40:lib/libdaisy/src/util/CpuLoadMeter.h ****             = smoothingFilterCutoffHz * 2.0f * 3.141592653f / blockRateInHz;
  41:lib/libdaisy/src/util/CpuLoadMeter.h ****         // according to
  42:lib/libdaisy/src/util/CpuLoadMeter.h ****         // https://en.wikipedia.org/wiki/Low-pass_filter#Simple_infinite_impulse_response_filter
  43:lib/libdaisy/src/util/CpuLoadMeter.h ****         smoothingConstant_ = cutoffNormalized / (cutoffNormalized + 1.0f);
  44:lib/libdaisy/src/util/CpuLoadMeter.h **** 
  45:lib/libdaisy/src/util/CpuLoadMeter.h ****         Reset();
  46:lib/libdaisy/src/util/CpuLoadMeter.h ****     }
  47:lib/libdaisy/src/util/CpuLoadMeter.h **** 
  48:lib/libdaisy/src/util/CpuLoadMeter.h ****     /** Call this at the beginning of your audio callback */
  49:lib/libdaisy/src/util/CpuLoadMeter.h ****     void OnBlockStart() { currentBlockStartTicks_ = System::GetTick(); }
  50:lib/libdaisy/src/util/CpuLoadMeter.h **** 
  51:lib/libdaisy/src/util/CpuLoadMeter.h ****     /** Call this at the end of your audio callback */
  52:lib/libdaisy/src/util/CpuLoadMeter.h ****     void OnBlockEnd()
  53:lib/libdaisy/src/util/CpuLoadMeter.h ****     {
  54:lib/libdaisy/src/util/CpuLoadMeter.h ****         const auto end         = System::GetTick();
  55:lib/libdaisy/src/util/CpuLoadMeter.h ****         const auto ticksPassed = end - currentBlockStartTicks_;
  56:lib/libdaisy/src/util/CpuLoadMeter.h ****         const auto currentBlockLoad
  57:lib/libdaisy/src/util/CpuLoadMeter.h ****             = float(ticksPassed) * ticksPerBlockInv_; // usPassed / usPerBlock
  58:lib/libdaisy/src/util/CpuLoadMeter.h **** 
  59:lib/libdaisy/src/util/CpuLoadMeter.h ****         if(firstCycle_)
  60:lib/libdaisy/src/util/CpuLoadMeter.h ****         {
  61:lib/libdaisy/src/util/CpuLoadMeter.h ****             max_ = min_ = avg_ = currentBlockLoad;
  62:lib/libdaisy/src/util/CpuLoadMeter.h ****             firstCycle_        = false;
  63:lib/libdaisy/src/util/CpuLoadMeter.h ****         }
  64:lib/libdaisy/src/util/CpuLoadMeter.h ****         else
  65:lib/libdaisy/src/util/CpuLoadMeter.h ****         {
  66:lib/libdaisy/src/util/CpuLoadMeter.h ****             if(currentBlockLoad > max_)
  67:lib/libdaisy/src/util/CpuLoadMeter.h ****                 max_ = currentBlockLoad;
ARM GAS  /var/folders/9s/8rp0_f2s1n31qbztm3b5_fdh0000gn/T//cckLE3ug.s 			page 4


  68:lib/libdaisy/src/util/CpuLoadMeter.h ****             if(currentBlockLoad < min_)
  69:lib/libdaisy/src/util/CpuLoadMeter.h ****                 min_ = currentBlockLoad;
  70:lib/libdaisy/src/util/CpuLoadMeter.h **** 
  71:lib/libdaisy/src/util/CpuLoadMeter.h ****             avg_ = smoothingConstant_ * currentBlockLoad
  72:lib/libdaisy/src/util/CpuLoadMeter.h ****                    + (1.0f - smoothingConstant_) * avg_;
  73:lib/libdaisy/src/util/CpuLoadMeter.h ****         }
  74:lib/libdaisy/src/util/CpuLoadMeter.h ****     }
  75:lib/libdaisy/src/util/CpuLoadMeter.h **** 
  76:lib/libdaisy/src/util/CpuLoadMeter.h ****     /** Returns the smoothed average CPU load in the range 0..1 */
  77:lib/libdaisy/src/util/CpuLoadMeter.h ****     float GetAvgCpuLoad() const { return avg_; }
  81              		.loc 2 77 11 view .LVU8
  82              	.LBB99:
  83              		.loc 2 77 35 view .LVU9
  84              		.loc 2 77 35 is_stmt 0 view .LVU10
  85              	.LBE99:
  86              	.LBE98:
  11:Thaumazein.cpp ****         int cpu_percent_int = static_cast<int>(avg_cpu_load * 100.0f);
  87              		.loc 1 11 9 is_stmt 1 view .LVU11
  12:Thaumazein.cpp ****         cpu_percent_int = cpu_percent_int < 0 ? 0 : (cpu_percent_int > 100 ? 100 : cpu_percent_int)
  88              		.loc 1 12 9 view .LVU12
  13:Thaumazein.cpp **** 
  14:Thaumazein.cpp ****         char buffer[32]; 
  89              		.loc 1 14 9 view .LVU13
  15:Thaumazein.cpp ****         sprintf(buffer, "CPU: %d", cpu_percent_int); 
  90              		.loc 1 15 9 view .LVU14
  91              	.LBB101:
  92              	.LBB100:
  93              		.loc 2 77 42 is_stmt 0 view .LVU15
  94 0010 2E4B     		ldr	r3, .L10+4
  95              	.LBE100:
  96              	.LBE101:
  97              		.loc 1 15 16 view .LVU16
  98 0012 6846     		mov	r0, sp
  11:Thaumazein.cpp ****         cpu_percent_int = cpu_percent_int < 0 ? 0 : (cpu_percent_int > 100 ? 100 : cpu_percent_int)
  99              		.loc 1 11 61 view .LVU17
 100 0014 9FED2E8A 		vldr.32	s16, .L10+8
 101              	.LBB102:
  16:Thaumazein.cpp ****         hw.PrintLine(buffer);
  17:Thaumazein.cpp ****         
  18:Thaumazein.cpp ****         // Determine current effective engine index again for display
  19:Thaumazein.cpp ****         int current_engine_idx = current_engine_index;
  20:Thaumazein.cpp ****         sprintf(buffer, "Engine: %d (%s)", current_engine_idx, (current_engine_idx <=3) ? "Poly-4" 
  21:Thaumazein.cpp ****         hw.PrintLine(buffer);
  22:Thaumazein.cpp ****         
  23:Thaumazein.cpp ****         // Print Smoothed Output Level
  24:Thaumazein.cpp ****         int level_percent = static_cast<int>(smoothed_output_level * 100.0f);
  25:Thaumazein.cpp ****         level_percent = level_percent < 0 ? 0 : (level_percent > 100 ? 100 : level_percent); // Cla
  26:Thaumazein.cpp ****         sprintf(buffer, "Level: %d%%", level_percent); 
  27:Thaumazein.cpp ****         hw.PrintLine(buffer);
  28:Thaumazein.cpp ****         
  29:Thaumazein.cpp ****         // Print all ADC raw values
  30:Thaumazein.cpp ****         for (int i = 0; i < 12; ++i) {
 102              		.loc 1 30 18 view .LVU18
 103 0018 0024     		movs	r4, #0
 104              	.LBE102:
  11:Thaumazein.cpp ****         cpu_percent_int = cpu_percent_int < 0 ? 0 : (cpu_percent_int > 100 ? 100 : cpu_percent_int)
 105              		.loc 1 11 61 view .LVU19
ARM GAS  /var/folders/9s/8rp0_f2s1n31qbztm3b5_fdh0000gn/T//cckLE3ug.s 			page 5


 106 001a 93ED057A 		vldr.32	s14, [r3, #20]
  15:Thaumazein.cpp ****         hw.PrintLine(buffer);
 107              		.loc 1 15 16 view .LVU20
 108 001e 2D49     		ldr	r1, .L10+12
  11:Thaumazein.cpp ****         cpu_percent_int = cpu_percent_int < 0 ? 0 : (cpu_percent_int > 100 ? 100 : cpu_percent_int)
 109              		.loc 1 11 61 view .LVU21
 110 0020 27EE087A 		vmul.f32	s14, s14, s16
  11:Thaumazein.cpp ****         cpu_percent_int = cpu_percent_int < 0 ? 0 : (cpu_percent_int > 100 ? 100 : cpu_percent_int)
 111              		.loc 1 11 13 view .LVU22
 112 0024 FDEEC77A 		vcvt.s32.f32	s15, s14
 113 0028 17EE902A 		vmov	r2, s15	@ int
  12:Thaumazein.cpp **** 
 114              		.loc 1 12 47 view .LVU23
 115 002c 642A     		cmp	r2, #100
 116 002e A8BF     		it	ge
 117 0030 6422     		movge	r2, #100
  15:Thaumazein.cpp ****         hw.PrintLine(buffer);
 118              		.loc 1 15 16 view .LVU24
 119 0032 22EAE272 		bic	r2, r2, r2, asr #31
 120 0036 FFF7FEFF 		bl	sprintf
 121              	.LVL1:
  16:Thaumazein.cpp ****         hw.PrintLine(buffer);
 122              		.loc 1 16 9 is_stmt 1 view .LVU25
 123              	.LBB105:
 124              	.LBI105:
 125              		.file 3 "lib/libdaisy/src/daisy_seed.h"
   1:lib/libdaisy/src/daisy_seed.h **** #pragma once
   2:lib/libdaisy/src/daisy_seed.h **** #ifndef DSY_SEED_H
   3:lib/libdaisy/src/daisy_seed.h **** #define DSY_SEED_H
   4:lib/libdaisy/src/daisy_seed.h **** 
   5:lib/libdaisy/src/daisy_seed.h **** #include "daisy.h"
   6:lib/libdaisy/src/daisy_seed.h **** 
   7:lib/libdaisy/src/daisy_seed.h **** //Uncomment this out if you're still using the rev2 hardware
   8:lib/libdaisy/src/daisy_seed.h **** //#define SEED_REV2
   9:lib/libdaisy/src/daisy_seed.h **** 
  10:lib/libdaisy/src/daisy_seed.h **** namespace daisy
  11:lib/libdaisy/src/daisy_seed.h **** {
  12:lib/libdaisy/src/daisy_seed.h **** /**
  13:lib/libdaisy/src/daisy_seed.h ****    @brief This is the higher-level interface for the Daisy board. \n 
  14:lib/libdaisy/src/daisy_seed.h ****     All basic peripheral configuration/initialization is setup here. \n
  15:lib/libdaisy/src/daisy_seed.h **** 
  16:lib/libdaisy/src/daisy_seed.h ****    @ingroup boards
  17:lib/libdaisy/src/daisy_seed.h **** */
  18:lib/libdaisy/src/daisy_seed.h **** class DaisySeed
  19:lib/libdaisy/src/daisy_seed.h **** {
  20:lib/libdaisy/src/daisy_seed.h ****   public:
  21:lib/libdaisy/src/daisy_seed.h ****     DaisySeed() {}
  22:lib/libdaisy/src/daisy_seed.h ****     ~DaisySeed() {}
  23:lib/libdaisy/src/daisy_seed.h **** 
  24:lib/libdaisy/src/daisy_seed.h ****     /** This function used to provide a pre-initialization configuraiton 
  25:lib/libdaisy/src/daisy_seed.h ****      *  it has since been deprecated, and does nothing.
  26:lib/libdaisy/src/daisy_seed.h ****      */
  27:lib/libdaisy/src/daisy_seed.h ****     void Configure();
  28:lib/libdaisy/src/daisy_seed.h **** 
  29:lib/libdaisy/src/daisy_seed.h ****     /** 
  30:lib/libdaisy/src/daisy_seed.h ****     Initializes the Daisy Seed and the following peripherals:
  31:lib/libdaisy/src/daisy_seed.h ****     SDRAM, QSPI, 24-bit 48kHz Audio via AK4556, Internal USB,
ARM GAS  /var/folders/9s/8rp0_f2s1n31qbztm3b5_fdh0000gn/T//cckLE3ug.s 			page 6


  32:lib/libdaisy/src/daisy_seed.h ****     as well as the built-in LED and Testpoint.
  33:lib/libdaisy/src/daisy_seed.h **** 
  34:lib/libdaisy/src/daisy_seed.h ****     ADCs, DACs, and other special peripherals (such as I2C, SPI, etc.)
  35:lib/libdaisy/src/daisy_seed.h ****     can be initialized using their specific initializers within libdaisy
  36:lib/libdaisy/src/daisy_seed.h ****     for a specific application.
  37:lib/libdaisy/src/daisy_seed.h ****     */
  38:lib/libdaisy/src/daisy_seed.h ****     void Init(bool boost = false);
  39:lib/libdaisy/src/daisy_seed.h **** 
  40:lib/libdaisy/src/daisy_seed.h ****     /** 
  41:lib/libdaisy/src/daisy_seed.h ****     Deinitializes all peripherals automatically handled by `Init`.
  42:lib/libdaisy/src/daisy_seed.h ****     */
  43:lib/libdaisy/src/daisy_seed.h ****     void DeInit();
  44:lib/libdaisy/src/daisy_seed.h **** 
  45:lib/libdaisy/src/daisy_seed.h ****     /** 
  46:lib/libdaisy/src/daisy_seed.h ****     Wait some ms before going on.
  47:lib/libdaisy/src/daisy_seed.h ****     \param del Delay time in ms.
  48:lib/libdaisy/src/daisy_seed.h ****     */
  49:lib/libdaisy/src/daisy_seed.h ****     void DelayMs(size_t del);
  50:lib/libdaisy/src/daisy_seed.h **** 
  51:lib/libdaisy/src/daisy_seed.h ****     /** 
  52:lib/libdaisy/src/daisy_seed.h ****     Returns the gpio_pin corresponding to the index 0-31.
  53:lib/libdaisy/src/daisy_seed.h ****     For the given GPIO on the Daisy Seed (labeled 1-32 in docs).
  54:lib/libdaisy/src/daisy_seed.h ****     */
  55:lib/libdaisy/src/daisy_seed.h ****     static dsy_gpio_pin GetPin(uint8_t pin_idx);
  56:lib/libdaisy/src/daisy_seed.h **** 
  57:lib/libdaisy/src/daisy_seed.h ****     /** Begins the audio for the seeds builtin audio.
  58:lib/libdaisy/src/daisy_seed.h ****     the specified callback will get called whenever
  59:lib/libdaisy/src/daisy_seed.h ****     new data is ready to be prepared.
  60:lib/libdaisy/src/daisy_seed.h ****     */
  61:lib/libdaisy/src/daisy_seed.h ****     void StartAudio(AudioHandle::InterleavingAudioCallback cb);
  62:lib/libdaisy/src/daisy_seed.h **** 
  63:lib/libdaisy/src/daisy_seed.h ****     /** Begins the audio for the seeds builtin audio.
  64:lib/libdaisy/src/daisy_seed.h ****     the specified callback will get called whenever
  65:lib/libdaisy/src/daisy_seed.h ****     new data is ready to be prepared.
  66:lib/libdaisy/src/daisy_seed.h ****     This will use the newer non-interleaved callback.
  67:lib/libdaisy/src/daisy_seed.h ****     */
  68:lib/libdaisy/src/daisy_seed.h ****     void StartAudio(AudioHandle::AudioCallback cb);
  69:lib/libdaisy/src/daisy_seed.h **** 
  70:lib/libdaisy/src/daisy_seed.h ****     /** Changes to a new interleaved callback
  71:lib/libdaisy/src/daisy_seed.h ****      */
  72:lib/libdaisy/src/daisy_seed.h ****     void ChangeAudioCallback(AudioHandle::InterleavingAudioCallback cb);
  73:lib/libdaisy/src/daisy_seed.h **** 
  74:lib/libdaisy/src/daisy_seed.h ****     /** Changes to a new multichannel callback
  75:lib/libdaisy/src/daisy_seed.h ****      */
  76:lib/libdaisy/src/daisy_seed.h ****     void ChangeAudioCallback(AudioHandle::AudioCallback cb);
  77:lib/libdaisy/src/daisy_seed.h **** 
  78:lib/libdaisy/src/daisy_seed.h ****     /** Stops the audio if it is running. */
  79:lib/libdaisy/src/daisy_seed.h ****     void StopAudio();
  80:lib/libdaisy/src/daisy_seed.h **** 
  81:lib/libdaisy/src/daisy_seed.h ****     /** Updates the Audio Sample Rate, and reinitializes.
  82:lib/libdaisy/src/daisy_seed.h ****      ** Audio must be stopped for this to work.
  83:lib/libdaisy/src/daisy_seed.h ****      */
  84:lib/libdaisy/src/daisy_seed.h ****     void SetAudioSampleRate(SaiHandle::Config::SampleRate samplerate);
  85:lib/libdaisy/src/daisy_seed.h **** 
  86:lib/libdaisy/src/daisy_seed.h ****     /** Returns the audio sample rate in Hz as a floating point number.
  87:lib/libdaisy/src/daisy_seed.h ****      */
  88:lib/libdaisy/src/daisy_seed.h ****     float AudioSampleRate();
ARM GAS  /var/folders/9s/8rp0_f2s1n31qbztm3b5_fdh0000gn/T//cckLE3ug.s 			page 7


  89:lib/libdaisy/src/daisy_seed.h **** 
  90:lib/libdaisy/src/daisy_seed.h ****     /** Sets the number of samples processed per channel by the audio callback.
  91:lib/libdaisy/src/daisy_seed.h ****      */
  92:lib/libdaisy/src/daisy_seed.h ****     void SetAudioBlockSize(size_t blocksize);
  93:lib/libdaisy/src/daisy_seed.h **** 
  94:lib/libdaisy/src/daisy_seed.h ****     /** Returns the number of samples per channel in a block of audio. */
  95:lib/libdaisy/src/daisy_seed.h ****     size_t AudioBlockSize();
  96:lib/libdaisy/src/daisy_seed.h **** 
  97:lib/libdaisy/src/daisy_seed.h ****     /** Returns the rate in Hz that the Audio callback is called */
  98:lib/libdaisy/src/daisy_seed.h ****     float AudioCallbackRate() const;
  99:lib/libdaisy/src/daisy_seed.h **** 
 100:lib/libdaisy/src/daisy_seed.h ****     /** Sets the state of the built in LED
 101:lib/libdaisy/src/daisy_seed.h ****      */
 102:lib/libdaisy/src/daisy_seed.h ****     void SetLed(bool state);
 103:lib/libdaisy/src/daisy_seed.h **** 
 104:lib/libdaisy/src/daisy_seed.h ****     /** Sets the state of the test point near pin 10
 105:lib/libdaisy/src/daisy_seed.h ****      */
 106:lib/libdaisy/src/daisy_seed.h ****     void SetTestPoint(bool state);
 107:lib/libdaisy/src/daisy_seed.h **** 
 108:lib/libdaisy/src/daisy_seed.h ****     /** Print formatted debug log message
 109:lib/libdaisy/src/daisy_seed.h ****      */
 110:lib/libdaisy/src/daisy_seed.h ****     template <typename... VA>
 111:lib/libdaisy/src/daisy_seed.h ****     static void Print(const char* format, VA... va)
 112:lib/libdaisy/src/daisy_seed.h ****     {
 113:lib/libdaisy/src/daisy_seed.h ****         Log::Print(format, va...);
 114:lib/libdaisy/src/daisy_seed.h ****     }
 115:lib/libdaisy/src/daisy_seed.h **** 
 116:lib/libdaisy/src/daisy_seed.h ****     /** Print formatted debug log message with automatic line termination
 117:lib/libdaisy/src/daisy_seed.h ****     */
 118:lib/libdaisy/src/daisy_seed.h ****     template <typename... VA>
 119:lib/libdaisy/src/daisy_seed.h ****     static void PrintLine(const char* format, VA... va)
 126              		.loc 3 119 17 view .LVU26
 127              	.LBB106:
 120:lib/libdaisy/src/daisy_seed.h ****     {
 121:lib/libdaisy/src/daisy_seed.h ****         Log::PrintLine(format, va...);
 128              		.loc 3 121 23 is_stmt 0 view .LVU27
 129 003a 6846     		mov	r0, sp
 130 003c FFF7FEFF 		bl	_ZN5daisy6LoggerILNS_17LoggerDestinationE1EE9PrintLineEPKcz
 131              	.LVL2:
 132              		.loc 3 121 23 view .LVU28
 133              	.LBE106:
 134              	.LBE105:
  19:Thaumazein.cpp ****         sprintf(buffer, "Engine: %d (%s)", current_engine_idx, (current_engine_idx <=3) ? "Poly-4" 
 135              		.loc 1 19 9 is_stmt 1 view .LVU29
  19:Thaumazein.cpp ****         sprintf(buffer, "Engine: %d (%s)", current_engine_idx, (current_engine_idx <=3) ? "Poly-4" 
 136              		.loc 1 19 34 is_stmt 0 view .LVU30
 137 0040 254B     		ldr	r3, .L10+16
  20:Thaumazein.cpp ****         hw.PrintLine(buffer);
 138              		.loc 1 20 16 view .LVU31
 139 0042 2649     		ldr	r1, .L10+20
 140 0044 6846     		mov	r0, sp
  19:Thaumazein.cpp ****         sprintf(buffer, "Engine: %d (%s)", current_engine_idx, (current_engine_idx <=3) ? "Poly-4" 
 141              		.loc 1 19 34 view .LVU32
 142 0046 1A68     		ldr	r2, [r3]
 143              	.LVL3:
  20:Thaumazein.cpp ****         hw.PrintLine(buffer);
 144              		.loc 1 20 9 is_stmt 1 view .LVU33
ARM GAS  /var/folders/9s/8rp0_f2s1n31qbztm3b5_fdh0000gn/T//cckLE3ug.s 			page 8


  20:Thaumazein.cpp ****         hw.PrintLine(buffer);
 145              		.loc 1 20 16 is_stmt 0 view .LVU34
 146 0048 254B     		ldr	r3, .L10+24
 147 004a 032A     		cmp	r2, #3
 148 004c D8BF     		it	le
 149 004e 0B46     		movle	r3, r1
 150 0050 2449     		ldr	r1, .L10+28
 151 0052 FFF7FEFF 		bl	sprintf
 152              	.LVL4:
  21:Thaumazein.cpp ****         
 153              		.loc 1 21 9 is_stmt 1 view .LVU35
 154              	.LBB107:
 155              	.LBI107:
 119:lib/libdaisy/src/daisy_seed.h ****     {
 156              		.loc 3 119 17 view .LVU36
 157              	.LBB108:
 158              		.loc 3 121 23 is_stmt 0 view .LVU37
 159 0056 6846     		mov	r0, sp
 160 0058 FFF7FEFF 		bl	_ZN5daisy6LoggerILNS_17LoggerDestinationE1EE9PrintLineEPKcz
 161              	.LVL5:
 162              		.loc 3 121 23 view .LVU38
 163              	.LBE108:
 164              	.LBE107:
  24:Thaumazein.cpp ****         level_percent = level_percent < 0 ? 0 : (level_percent > 100 ? 100 : level_percent); // Cla
 165              		.loc 1 24 9 is_stmt 1 view .LVU39
  24:Thaumazein.cpp ****         level_percent = level_percent < 0 ? 0 : (level_percent > 100 ? 100 : level_percent); // Cla
 166              		.loc 1 24 46 is_stmt 0 view .LVU40
 167 005c 224B     		ldr	r3, .L10+32
  26:Thaumazein.cpp ****         hw.PrintLine(buffer);
 168              		.loc 1 26 16 view .LVU41
 169 005e 2349     		ldr	r1, .L10+36
 170 0060 6846     		mov	r0, sp
  24:Thaumazein.cpp ****         level_percent = level_percent < 0 ? 0 : (level_percent > 100 ? 100 : level_percent); // Cla
 171              		.loc 1 24 46 view .LVU42
 172 0062 D3ED007A 		vldr.32	s15, [r3]
 173              	.LVL6:
  25:Thaumazein.cpp ****         sprintf(buffer, "Level: %d%%", level_percent); 
 174              		.loc 1 25 9 is_stmt 1 view .LVU43
  26:Thaumazein.cpp ****         hw.PrintLine(buffer);
 175              		.loc 1 26 9 view .LVU44
  24:Thaumazein.cpp ****         level_percent = level_percent < 0 ? 0 : (level_percent > 100 ? 100 : level_percent); // Cla
 176              		.loc 1 24 68 is_stmt 0 view .LVU45
 177 0066 67EE887A 		vmul.f32	s15, s15, s16
 178              	.LVL7:
  24:Thaumazein.cpp ****         level_percent = level_percent < 0 ? 0 : (level_percent > 100 ? 100 : level_percent); // Cla
 179              		.loc 1 24 76 view .LVU46
 180 006a FDEEE77A 		vcvt.s32.f32	s15, s15
 181 006e 17EE902A 		vmov	r2, s15	@ int
  25:Thaumazein.cpp ****         sprintf(buffer, "Level: %d%%", level_percent); 
 182              		.loc 1 25 43 view .LVU47
 183 0072 642A     		cmp	r2, #100
 184 0074 A8BF     		it	ge
 185 0076 6422     		movge	r2, #100
  26:Thaumazein.cpp ****         hw.PrintLine(buffer);
 186              		.loc 1 26 16 view .LVU48
 187 0078 22EAE272 		bic	r2, r2, r2, asr #31
 188 007c FFF7FEFF 		bl	sprintf
ARM GAS  /var/folders/9s/8rp0_f2s1n31qbztm3b5_fdh0000gn/T//cckLE3ug.s 			page 9


 189              	.LVL8:
  27:Thaumazein.cpp ****         
 190              		.loc 1 27 9 is_stmt 1 view .LVU49
 191              	.LBB109:
 192              	.LBI109:
 119:lib/libdaisy/src/daisy_seed.h ****     {
 193              		.loc 3 119 17 view .LVU50
 194              	.LBB110:
 195              		.loc 3 121 23 is_stmt 0 view .LVU51
 196 0080 6846     		mov	r0, sp
 197 0082 FFF7FEFF 		bl	_ZN5daisy6LoggerILNS_17LoggerDestinationE1EE9PrintLineEPKcz
 198              	.LVL9:
 199              		.loc 3 121 23 view .LVU52
 200              	.LBE110:
 201              	.LBE109:
 202              		.loc 1 30 9 is_stmt 1 view .LVU53
 203              	.LBB111:
 204              		.loc 1 30 27 view .LVU54
 205              	.L4:
  31:Thaumazein.cpp ****             // Print ADC values as integers (multiplied by 1000 for precision)
  32:Thaumazein.cpp ****             sprintf(buffer, "ADC[%d]: %d", i, static_cast<int>(adc_raw_values[i] * 1000));
 206              		.loc 1 32 13 view .LVU55
 207              		.loc 1 32 80 is_stmt 0 view .LVU56
 208 0086 1A4B     		ldr	r3, .L10+40
 209              		.loc 1 32 20 view .LVU57
 210 0088 2246     		mov	r2, r4
 211              		.loc 1 32 82 view .LVU58
 212 008a 9FED1A7A 		vldr.32	s14, .L10+44
 213              		.loc 1 32 20 view .LVU59
 214 008e 6846     		mov	r0, sp
 215              		.loc 1 32 80 view .LVU60
 216 0090 03EB8403 		add	r3, r3, r4, lsl #2
 217              		.loc 1 32 20 view .LVU61
 218 0094 1849     		ldr	r1, .L10+48
  30:Thaumazein.cpp ****             // Print ADC values as integers (multiplied by 1000 for precision)
 219              		.loc 1 30 9 view .LVU62
 220 0096 0134     		adds	r4, r4, #1
 221              	.LVL10:
 222              		.loc 1 32 80 view .LVU63
 223 0098 D3ED007A 		vldr.32	s15, [r3]
 224              		.loc 1 32 82 view .LVU64
 225 009c 67EE877A 		vmul.f32	s15, s15, s14
 226              		.loc 1 32 20 view .LVU65
 227 00a0 FDEEE77A 		vcvt.s32.f32	s15, s15
 228 00a4 17EE903A 		vmov	r3, s15	@ int
 229 00a8 FFF7FEFF 		bl	sprintf
 230              	.LVL11:
  33:Thaumazein.cpp ****             hw.PrintLine(buffer);
 231              		.loc 1 33 13 is_stmt 1 view .LVU66
 232              	.LBB103:
 233              	.LBI103:
 119:lib/libdaisy/src/daisy_seed.h ****     {
 234              		.loc 3 119 17 view .LVU67
 235              	.LBB104:
 236              		.loc 3 121 23 is_stmt 0 view .LVU68
 237 00ac 6846     		mov	r0, sp
 238 00ae FFF7FEFF 		bl	_ZN5daisy6LoggerILNS_17LoggerDestinationE1EE9PrintLineEPKcz
ARM GAS  /var/folders/9s/8rp0_f2s1n31qbztm3b5_fdh0000gn/T//cckLE3ug.s 			page 10


 239              	.LVL12:
 240              		.loc 3 121 23 view .LVU69
 241              	.LBE104:
 242              	.LBE103:
  30:Thaumazein.cpp ****             // Print ADC values as integers (multiplied by 1000 for precision)
 243              		.loc 1 30 9 is_stmt 1 view .LVU70
  30:Thaumazein.cpp ****             // Print ADC values as integers (multiplied by 1000 for precision)
 244              		.loc 1 30 27 view .LVU71
 245 00b2 0C2C     		cmp	r4, #12
 246 00b4 E7D1     		bne	.L4
 247              	.LBE111:
  34:Thaumazein.cpp ****         }
  35:Thaumazein.cpp ****         
  36:Thaumazein.cpp ****         hw.PrintLine("--------"); 
 248              		.loc 1 36 9 view .LVU72
 249              	.LVL13:
 250              	.LBB112:
 251              	.LBI112:
 119:lib/libdaisy/src/daisy_seed.h ****     {
 252              		.loc 3 119 17 view .LVU73
 253              	.LBB113:
 254              		.loc 3 121 23 is_stmt 0 view .LVU74
 255 00b6 1148     		ldr	r0, .L10+52
 256 00b8 FFF7FEFF 		bl	_ZN5daisy6LoggerILNS_17LoggerDestinationE1EE9PrintLineEPKcz
 257              	.LVL14:
 258              		.loc 3 121 23 view .LVU75
 259              	.LBE113:
 260              	.LBE112:
  37:Thaumazein.cpp ****         
  38:Thaumazein.cpp ****         update_display = false; 
 261              		.loc 1 38 9 is_stmt 1 view .LVU76
 262              		.loc 1 38 24 is_stmt 0 view .LVU77
 263 00bc 0023     		movs	r3, #0
 264 00be 2B70     		strb	r3, [r5]
 265              	.LVL15:
 266              	.L1:
 267              		.loc 1 38 24 view .LVU78
 268              	.LBE97:
 269              	.LBE96:
 270              	.LBE95:
  39:Thaumazein.cpp ****     }
  40:Thaumazein.cpp **** }
 271              		.loc 1 40 1 view .LVU79
 272 00c0 09B0     		add	sp, sp, #36
 273              		.cfi_def_cfa_offset 20
 274              		@ sp needed
 275 00c2 BDEC028B 		vldm	sp!, {d8}
 276              		.cfi_restore 80
 277              		.cfi_restore 81
 278              		.cfi_def_cfa_offset 12
 279 00c6 30BD     		pop	{r4, r5, pc}
 280              	.L11:
 281              		.align	2
 282              	.L10:
 283 00c8 00000000 		.word	update_display
 284 00cc 00000000 		.word	cpu_meter
 285 00d0 0000C842 		.word	1120403456
ARM GAS  /var/folders/9s/8rp0_f2s1n31qbztm3b5_fdh0000gn/T//cckLE3ug.s 			page 11


 286 00d4 0C000000 		.word	.LC4
 287 00d8 00000000 		.word	current_engine_index
 288 00dc 00000000 		.word	.LC2
 289 00e0 07000000 		.word	.LC3
 290 00e4 14000000 		.word	.LC5
 291 00e8 00000000 		.word	smoothed_output_level
 292 00ec 24000000 		.word	.LC6
 293 00f0 00000000 		.word	adc_raw_values
 294 00f4 00007A44 		.word	1148846080
 295 00f8 30000000 		.word	.LC7
 296 00fc 3C000000 		.word	.LC8
 297              		.cfi_endproc
 298              	.LFE5343:
 300              		.section	.text._Z15PollTouchSensorv,"ax",%progbits
 301              		.align	1
 302              		.global	_Z15PollTouchSensorv
 303              		.syntax unified
 304              		.thumb
 305              		.thumb_func
 307              	_Z15PollTouchSensorv:
 308              	.LFB5344:
  41:Thaumazein.cpp **** 
  42:Thaumazein.cpp **** // Poll the touch sensor and update shared variables
  43:Thaumazein.cpp **** void PollTouchSensor() {
 309              		.loc 1 43 24 is_stmt 1 view -0
 310              		.cfi_startproc
 311              		@ args = 0, pretend = 0, frame = 32
 312              		@ frame_needed = 0, uses_anonymous_args = 0
  44:Thaumazein.cpp ****     // Recover from any I2C errors on the touch sensor
  45:Thaumazein.cpp ****     if(touch_sensor.HasError()) {
 313              		.loc 1 45 5 view .LVU81
  43:Thaumazein.cpp ****     // Recover from any I2C errors on the touch sensor
 314              		.loc 1 43 24 is_stmt 0 view .LVU82
 315 0000 2DE9F04F 		push	{r4, r5, r6, r7, r8, r9, r10, fp, lr}
 316              		.cfi_def_cfa_offset 36
 317              		.cfi_offset 4, -36
 318              		.cfi_offset 5, -32
 319              		.cfi_offset 6, -28
 320              		.cfi_offset 7, -24
 321              		.cfi_offset 8, -20
 322              		.cfi_offset 9, -16
 323              		.cfi_offset 10, -12
 324              		.cfi_offset 11, -8
 325              		.cfi_offset 14, -4
 326              	.LBB151:
 327              		.loc 1 45 29 view .LVU83
 328 0004 8B48     		ldr	r0, .L45
 329              	.LBE151:
  43:Thaumazein.cpp ****     // Recover from any I2C errors on the touch sensor
 330              		.loc 1 43 24 view .LVU84
 331 0006 2DED048B 		vpush.64	{d8, d9}
 332              		.cfi_def_cfa_offset 52
 333              		.cfi_offset 80, -52
 334              		.cfi_offset 81, -48
 335              		.cfi_offset 82, -44
 336              		.cfi_offset 83, -40
 337 000a 89B0     		sub	sp, sp, #36
ARM GAS  /var/folders/9s/8rp0_f2s1n31qbztm3b5_fdh0000gn/T//cckLE3ug.s 			page 12


 338              		.cfi_def_cfa_offset 88
 339              	.LBB165:
 340              		.loc 1 45 29 view .LVU85
 341 000c FFF7FEFF 		bl	_ZNK6Mpr1218HasErrorEv
 342              	.LVL16:
 343              		.loc 1 45 5 view .LVU86
 344 0010 E8B1     		cbz	r0, .L13
 345              	.LBB152:
  46:Thaumazein.cpp ****         touch_sensor.ClearError();
 346              		.loc 1 46 9 is_stmt 1 view .LVU87
 347              		.loc 1 46 32 is_stmt 0 view .LVU88
 348 0012 8848     		ldr	r0, .L45
 349 0014 FFF7FEFF 		bl	_ZN6Mpr12110ClearErrorEv
 350              	.LVL17:
  47:Thaumazein.cpp ****         Mpr121::Config cfg;
 351              		.loc 1 47 9 is_stmt 1 view .LVU89
 352              	.LBB153:
 353              	.LBI153:
 354              		.file 4 "mpr121_daisy.h"
   1:mpr121_daisy.h **** #pragma once
   2:mpr121_daisy.h **** #ifndef MPR121_DAISY_H
   3:mpr121_daisy.h **** #define MPR121_DAISY_H
   4:mpr121_daisy.h **** 
   5:mpr121_daisy.h **** #include "daisy_seed.h"
   6:mpr121_daisy.h **** #include "per/i2c.h"
   7:mpr121_daisy.h **** 
   8:mpr121_daisy.h **** using namespace daisy;
   9:mpr121_daisy.h **** 
  10:mpr121_daisy.h **** /// mp
  11:mpr121_daisy.h **** 
  12:mpr121_daisy.h **** // Register map
  13:mpr121_daisy.h **** #define MPR121_TOUCHSTATUS_L 0x00
  14:mpr121_daisy.h **** #define MPR121_TOUCHSTATUS_H 0x01
  15:mpr121_daisy.h **** #define MPR121_FILTDATA_0L 0x04
  16:mpr121_daisy.h **** #define MPR121_FILTDATA_0H 0x05
  17:mpr121_daisy.h **** #define MPR121_BASELINE_0 0x1E
  18:mpr121_daisy.h **** #define MPR121_MHDR 0x2B
  19:mpr121_daisy.h **** #define MPR121_NHDR 0x2C
  20:mpr121_daisy.h **** #define MPR121_NCLR 0x2D
  21:mpr121_daisy.h **** #define MPR121_FDLR 0x2E
  22:mpr121_daisy.h **** #define MPR121_MHDF 0x2F
  23:mpr121_daisy.h **** #define MPR121_NHDF 0x30
  24:mpr121_daisy.h **** #define MPR121_NCLF 0x31
  25:mpr121_daisy.h **** #define MPR121_FDLF 0x32
  26:mpr121_daisy.h **** #define MPR121_NHDT 0x33
  27:mpr121_daisy.h **** #define MPR121_NCLT 0x34
  28:mpr121_daisy.h **** #define MPR121_FDLT 0x35
  29:mpr121_daisy.h **** 
  30:mpr121_daisy.h **** #define MPR121_TOUCHTH_0 0x41
  31:mpr121_daisy.h **** #define MPR121_RELEASETH_0 0x42
  32:mpr121_daisy.h **** #define MPR121_DEBOUNCE 0x5B
  33:mpr121_daisy.h **** #define MPR121_CONFIG1 0x5C
  34:mpr121_daisy.h **** #define MPR121_CONFIG2 0x5D
  35:mpr121_daisy.h **** #define MPR121_CHARGECURR_0 0x5F
  36:mpr121_daisy.h **** #define MPR121_CHARGETIME_1 0x6C
  37:mpr121_daisy.h **** #define MPR121_ECR 0x5E
  38:mpr121_daisy.h **** #define MPR121_AUTOCONFIG0 0x7B
ARM GAS  /var/folders/9s/8rp0_f2s1n31qbztm3b5_fdh0000gn/T//cckLE3ug.s 			page 13


  39:mpr121_daisy.h **** #define MPR121_AUTOCONFIG1 0x7C
  40:mpr121_daisy.h **** #define MPR121_UPLIMIT 0x7D
  41:mpr121_daisy.h **** #define MPR121_LOWLIMIT 0x7E
  42:mpr121_daisy.h **** #define MPR121_TARGETLIMIT 0x7F
  43:mpr121_daisy.h **** 
  44:mpr121_daisy.h **** #define MPR121_GPIODIR 0x76
  45:mpr121_daisy.h **** #define MPR121_GPIOEN 0x77
  46:mpr121_daisy.h **** #define MPR121_GPIOSET 0x78
  47:mpr121_daisy.h **** #define MPR121_GPIOCLR 0x79
  48:mpr121_daisy.h **** #define MPR121_GPIOTOGGLE 0x7A
  49:mpr121_daisy.h **** 
  50:mpr121_daisy.h **** #define MPR121_SOFTRESET 0x80
  51:mpr121_daisy.h **** #define MPR121_I2CADDR_DEFAULT 0x5A
  52:mpr121_daisy.h **** 
  53:mpr121_daisy.h **** class Mpr121
  54:mpr121_daisy.h **** {
  55:mpr121_daisy.h ****   public:
  56:mpr121_daisy.h ****     Mpr121() {}
  57:mpr121_daisy.h ****     ~Mpr121() {}
  58:mpr121_daisy.h **** 
  59:mpr121_daisy.h ****     struct Config
 355              		.loc 4 59 12 view .LVU90
 356              	.LBB154:
 357              	.LBI154:
 358              		.file 5 "lib/libdaisy/src/per/i2c.h"
   1:lib/libdaisy/src/per/i2c.h **** #pragma once
   2:lib/libdaisy/src/per/i2c.h **** #include "daisy_core.h"
   3:lib/libdaisy/src/per/i2c.h **** 
   4:lib/libdaisy/src/per/i2c.h **** namespace daisy
   5:lib/libdaisy/src/per/i2c.h **** {
   6:lib/libdaisy/src/per/i2c.h **** /** A handle for interacting with an I2C peripheral. This is a dumb
   7:lib/libdaisy/src/per/i2c.h ****  *  gateway that internally points to one of the four I2C peripherals
   8:lib/libdaisy/src/per/i2c.h ****  *  after it was initialised. It can then be copied and passed around.
   9:lib/libdaisy/src/per/i2c.h ****  *  Use an I2CHandle like this:
  10:lib/libdaisy/src/per/i2c.h ****  *  
  11:lib/libdaisy/src/per/i2c.h ****  *      // setup the configuration
  12:lib/libdaisy/src/per/i2c.h ****  *      I2CHandle::Config i2c_conf;
  13:lib/libdaisy/src/per/i2c.h ****  *      i2c_conf.periph = I2CHandle::Config::Peripheral::I2C_1;
  14:lib/libdaisy/src/per/i2c.h ****  *      i2c_conf.speed  = I2CHandle::Config::Speed::I2C_400KHZ;
  15:lib/libdaisy/src/per/i2c.h ****  *      i2c_conf.mode   = I2CHandle::Config::Mode::Master;
  16:lib/libdaisy/src/per/i2c.h ****  *      i2c_conf.pin_config.scl  = {DSY_GPIOB, 8};
  17:lib/libdaisy/src/per/i2c.h ****  *      i2c_conf.pin_config.sda  = {DSY_GPIOB, 9};
  18:lib/libdaisy/src/per/i2c.h ****  *      // initialise the peripheral
  19:lib/libdaisy/src/per/i2c.h ****  *      I2CHandle i2c;
  20:lib/libdaisy/src/per/i2c.h ****  *      i2c.Init(i2c_conf);
  21:lib/libdaisy/src/per/i2c.h ****  *      // now i2c points to the corresponding peripheral and can be used.
  22:lib/libdaisy/src/per/i2c.h ****  *      i2c.TransmitBlocking( ... );
  23:lib/libdaisy/src/per/i2c.h ****  */
  24:lib/libdaisy/src/per/i2c.h **** class I2CHandle
  25:lib/libdaisy/src/per/i2c.h **** {
  26:lib/libdaisy/src/per/i2c.h ****   public:
  27:lib/libdaisy/src/per/i2c.h ****     /** Contains settings for initialising an I2C interface. */
  28:lib/libdaisy/src/per/i2c.h ****     struct Config
 359              		.loc 5 28 12 view .LVU91
 360              	.LBB155:
 361 0018 1023     		movs	r3, #16
 362              	.LBE155:
ARM GAS  /var/folders/9s/8rp0_f2s1n31qbztm3b5_fdh0000gn/T//cckLE3ug.s 			page 14


 363              	.LBE154:
 364              	.LBE153:
 365              	.LBB158:
 366              	.LBB159:
  60:mpr121_daisy.h ****     {
  61:mpr121_daisy.h ****         I2CHandle::Config i2c_config;
  62:mpr121_daisy.h ****         uint8_t          i2c_address;
  63:mpr121_daisy.h **** 
  64:mpr121_daisy.h ****         void Defaults()
  65:mpr121_daisy.h ****         {
  66:mpr121_daisy.h ****             i2c_config.periph = I2CHandle::Config::Peripheral::I2C_1;
  67:mpr121_daisy.h ****             i2c_config.speed  = I2CHandle::Config::Speed::I2C_400KHZ;
 367              		.loc 4 67 31 is_stmt 0 view .LVU92
 368 001a 0122     		movs	r2, #1
 369              	.LBE159:
 370              	.LBE158:
  48:Thaumazein.cpp ****         cfg.Defaults();
  49:Thaumazein.cpp ****         touch_sensor.Init(cfg);
 371              		.loc 1 49 26 view .LVU93
 372 001c 02A9     		add	r1, sp, #8
 373              	.LVL18:
 374              	.LBB162:
 375              	.LBB157:
 376              	.LBB156:
 377              		.loc 5 28 12 view .LVU94
 378 001e 8DF81830 		strb	r3, [sp, #24]
 379              	.LVL19:
 380              		.loc 5 28 12 view .LVU95
 381              	.LBE156:
 382              	.LBE157:
 383              	.LBE162:
  48:Thaumazein.cpp ****         cfg.Defaults();
 384              		.loc 1 48 9 is_stmt 1 view .LVU96
 385              	.LBB163:
 386              	.LBI158:
  64:mpr121_daisy.h ****         {
 387              		.loc 4 64 14 view .LVU97
 388              	.LBB160:
  66:mpr121_daisy.h ****             i2c_config.speed  = I2CHandle::Config::Speed::I2C_400KHZ;
 389              		.loc 4 66 13 view .LVU98
  66:mpr121_daisy.h ****             i2c_config.speed  = I2CHandle::Config::Speed::I2C_400KHZ;
 390              		.loc 4 66 31 is_stmt 0 view .LVU99
 391 0022 0023     		movs	r3, #0
 392              	.LBE160:
 393              	.LBE163:
 394              		.loc 1 49 26 view .LVU100
 395 0024 8348     		ldr	r0, .L45
 396              	.LBB164:
 397              	.LBB161:
  66:mpr121_daisy.h ****             i2c_config.speed  = I2CHandle::Config::Speed::I2C_400KHZ;
 398              		.loc 4 66 31 view .LVU101
 399 0026 0293     		str	r3, [sp, #8]
 400              		.loc 4 67 13 is_stmt 1 view .LVU102
  68:mpr121_daisy.h ****             i2c_config.mode   = I2CHandle::Config::Mode::I2C_MASTER;
 401              		.loc 4 68 31 is_stmt 0 view .LVU103
 402 0028 CDE90423 		strd	r2, r3, [sp, #16]
  69:mpr121_daisy.h ****             i2c_config.pin_config.scl = {DSY_GPIOB, 8};
ARM GAS  /var/folders/9s/8rp0_f2s1n31qbztm3b5_fdh0000gn/T//cckLE3ug.s 			page 15


 403              		.loc 4 69 13 is_stmt 1 view .LVU104
 404              		.loc 4 69 39 is_stmt 0 view .LVU105
 405 002c 824B     		ldr	r3, .L45+4
 406 002e 1A88     		ldrh	r2, [r3]	@ unaligned
  70:mpr121_daisy.h ****             i2c_config.pin_config.sda = {DSY_GPIOB, 9};
 407              		.loc 4 70 39 view .LVU106
 408 0030 5B88     		ldrh	r3, [r3, #2]	@ unaligned
  69:mpr121_daisy.h ****             i2c_config.pin_config.scl = {DSY_GPIOB, 8};
 409              		.loc 4 69 39 view .LVU107
 410 0032 ADF80C20 		strh	r2, [sp, #12]	@ unaligned
 411              		.loc 4 70 13 is_stmt 1 view .LVU108
 412              		.loc 4 70 39 is_stmt 0 view .LVU109
 413 0036 ADF80E30 		strh	r3, [sp, #14]	@ unaligned
  71:mpr121_daisy.h ****             i2c_address               = MPR121_I2CADDR_DEFAULT;
 414              		.loc 4 71 13 is_stmt 1 view .LVU110
 415              		.loc 4 71 39 is_stmt 0 view .LVU111
 416 003a 5A23     		movs	r3, #90
 417 003c 8DF81C30 		strb	r3, [sp, #28]
 418              	.LVL20:
 419              		.loc 4 71 39 view .LVU112
 420              	.LBE161:
 421              	.LBE164:
 422              		.loc 1 49 9 is_stmt 1 view .LVU113
 423              		.loc 1 49 26 is_stmt 0 view .LVU114
 424 0040 FFF7FEFF 		bl	_ZN6Mpr1214InitERKNS_6ConfigE
 425              	.LVL21:
  50:Thaumazein.cpp ****         touch_sensor.SetThresholds(6, 3);
 426              		.loc 1 50 9 is_stmt 1 view .LVU115
 427              		.loc 1 50 35 is_stmt 0 view .LVU116
 428 0044 0322     		movs	r2, #3
 429 0046 0621     		movs	r1, #6
 430 0048 7A48     		ldr	r0, .L45
 431 004a FFF7FEFF 		bl	_ZN6Mpr12113SetThresholdsEhh
 432              	.LVL22:
 433              	.L13:
 434              	.LBE152:
 435              	.LBE165:
  51:Thaumazein.cpp ****     }
  52:Thaumazein.cpp ****     uint16_t touched = touch_sensor.Touched();
 436              		.loc 1 52 5 is_stmt 1 view .LVU117
 437              		.loc 1 52 44 is_stmt 0 view .LVU118
 438 004e 7948     		ldr	r0, .L45
  53:Thaumazein.cpp ****     current_touch_state = touched;
  54:Thaumazein.cpp **** 
  55:Thaumazein.cpp ****     // Update touch pad LEDs with touch and ARP blink
  56:Thaumazein.cpp ****     uint32_t now = hw.system.GetNow();
  57:Thaumazein.cpp ****     bool arp_on = arp.IsActive();
 439              		.loc 1 57 31 view .LVU119
 440 0050 0B25     		movs	r5, #11
  52:Thaumazein.cpp ****     current_touch_state = touched;
 441              		.loc 1 52 44 view .LVU120
 442 0052 FFF7FEFF 		bl	_ZN6Mpr1217TouchedEv
 443              	.LVL23:
  53:Thaumazein.cpp ****     current_touch_state = touched;
 444              		.loc 1 53 25 view .LVU121
 445 0056 794B     		ldr	r3, .L45+8
  52:Thaumazein.cpp ****     current_touch_state = touched;
ARM GAS  /var/folders/9s/8rp0_f2s1n31qbztm3b5_fdh0000gn/T//cckLE3ug.s 			page 16


 446              		.loc 1 52 44 view .LVU122
 447 0058 0646     		mov	r6, r0
 448              	.LVL24:
  53:Thaumazein.cpp ****     current_touch_state = touched;
 449              		.loc 1 53 5 is_stmt 1 view .LVU123
 450 005a DFF810A2 		ldr	r10, .L45+56
  53:Thaumazein.cpp ****     current_touch_state = touched;
 451              		.loc 1 53 25 is_stmt 0 view .LVU124
 452 005e 1880     		strh	r0, [r3]	@ movhi
  56:Thaumazein.cpp ****     bool arp_on = arp.IsActive();
 453              		.loc 1 56 5 is_stmt 1 view .LVU125
  56:Thaumazein.cpp ****     bool arp_on = arp.IsActive();
 454              		.loc 1 56 36 is_stmt 0 view .LVU126
 455 0060 FFF7FEFF 		bl	_ZN5daisy6System6GetNowEv
 456              	.LVL25:
  56:Thaumazein.cpp ****     bool arp_on = arp.IsActive();
 457              		.loc 1 56 36 view .LVU127
 458 0064 8046     		mov	r8, r0
 459              	.LVL26:
 460              		.loc 1 57 5 is_stmt 1 view .LVU128
 461              		.loc 1 57 31 is_stmt 0 view .LVU129
 462 0066 7648     		ldr	r0, .L45+12
 463              	.LVL27:
 464              		.loc 1 57 31 view .LVU130
 465 0068 FFF7FEFF 		bl	_ZNK11Arpeggiator8IsActiveEv
 466              	.LVL28:
 467 006c 754C     		ldr	r4, .L45+16
 468 006e 8146     		mov	r9, r0
 469              	.LVL29:
  58:Thaumazein.cpp ****     const float sensitivity = 150.0f;
 470              		.loc 1 58 5 is_stmt 1 view .LVU131
  59:Thaumazein.cpp ****     const float alpha = 0.01f; // EVEN slower smoothing coefficient
 471              		.loc 1 59 5 view .LVU132
  60:Thaumazein.cpp ****     for(int i = 0; i < 12; ++i) {
 472              		.loc 1 60 5 view .LVU133
 473              	.LBB166:
 474              		.loc 1 60 22 view .LVU134
 475              	.L24:
 476              	.LBB167:
  61:Thaumazein.cpp ****         int ledIdx = 11 - i;  // pad i maps to LED[11-i]
  62:Thaumazein.cpp ****         bool padTouched = (touched & (1 << i)) != 0;
  63:Thaumazein.cpp ****         bool blink     = (now - arp_led_timestamps[ledIdx]) < ARP_LED_DURATION_MS;
 477              		.loc 1 63 58 is_stmt 0 view .LVU135
 478 0070 754B     		ldr	r3, .L45+20
 479 0072 B7EE008A 		vmov.f32	s16, #1.0e+0
 480 0076 C5F10B01 		rsb	r1, r5, #11
 481              	.LVL30:
  61:Thaumazein.cpp ****         int ledIdx = 11 - i;  // pad i maps to LED[11-i]
 482              		.loc 1 61 9 is_stmt 1 view .LVU136
  62:Thaumazein.cpp ****         bool blink     = (now - arp_led_timestamps[ledIdx]) < ARP_LED_DURATION_MS;
 483              		.loc 1 62 9 view .LVU137
 484              		.loc 1 63 9 view .LVU138
 485 007a DFED748A 		vldr.32	s17, .L45+24
 486              		.loc 1 63 58 is_stmt 0 view .LVU139
 487 007e 53F82570 		ldr	r7, [r3, r5, lsl #2]
 488              		.loc 1 63 63 view .LVU140
 489 0082 734B     		ldr	r3, .L45+28
ARM GAS  /var/folders/9s/8rp0_f2s1n31qbztm3b5_fdh0000gn/T//cckLE3ug.s 			page 17


 490              		.loc 1 63 31 view .LVU141
 491 0084 A8EB0707 		sub	r7, r8, r7
 492              		.loc 1 63 63 view .LVU142
 493 0088 1B68     		ldr	r3, [r3]
 494 008a 0193     		str	r3, [sp, #4]
 495              	.LVL31:
  64:Thaumazein.cpp **** 
  65:Thaumazein.cpp ****         float current_smoothed_brightness = 0.0f;
 496              		.loc 1 65 9 is_stmt 1 view .LVU143
  66:Thaumazein.cpp ****         float target_brightness = 0.0f;
 497              		.loc 1 66 9 view .LVU144
  67:Thaumazein.cpp **** 
  68:Thaumazein.cpp ****         if(arp_on) {
 498              		.loc 1 68 9 view .LVU145
 499              	.LBB168:
 500 008c B9F1000F 		cmp	r9, #0
 501 0090 49D0     		beq	.L14
  69:Thaumazein.cpp ****             // When ARP is on, brightness is purely determined by blink state
  70:Thaumazein.cpp ****             current_smoothed_brightness = blink ? 1.0f : 0.0f;
 502              		.loc 1 70 13 view .LVU146
 503              		.loc 1 70 49 is_stmt 0 view .LVU147
 504 0092 9F42     		cmp	r7, r3
 505 0094 2CBF     		ite	cs
 506 0096 F0EE687A 		vmovcs.f32	s15, s17
 507 009a F0EE487A 		vmovcc.f32	s15, s16
 508              	.LVL32:
  71:Thaumazein.cpp ****             // Reset smoothed level when ARP is active to avoid carry-over brightness
  72:Thaumazein.cpp ****             pad_led_levels[ledIdx] = current_smoothed_brightness;
 509              		.loc 1 72 13 is_stmt 1 view .LVU148
 510              		.loc 1 72 36 is_stmt 0 view .LVU149
 511 009e C4ED0B7A 		vstr.32	s15, [r4, #44]
 512              	.LVL33:
 513              	.L16:
 514              		.loc 1 72 36 view .LVU150
 515              	.LBE168:
  73:Thaumazein.cpp ****         } else {
  74:Thaumazein.cpp ****             // When ARP is off, use pressure sensing
  75:Thaumazein.cpp ****             if(padTouched) {
  76:Thaumazein.cpp ****                 int16_t deviation = touch_sensor.GetBaselineDeviation(i);
  77:Thaumazein.cpp ****                 target_brightness = daisysp::fmax(0.0f, daisysp::fmin(1.0f, deviation / sensitivity
  78:Thaumazein.cpp ****                 // Apply smoothing to the target brightness
  79:Thaumazein.cpp ****                 pad_led_levels[ledIdx] = pad_led_levels[ledIdx] * (1.0f - alpha) + target_brightnes
  80:Thaumazein.cpp ****             } else {
  81:Thaumazein.cpp ****                  // If not touched, decay the smoothed value towards 0 
  82:Thaumazein.cpp ****                  pad_led_levels[ledIdx] = pad_led_levels[ledIdx] * (1.0f - alpha);
  83:Thaumazein.cpp ****                  // Ensure target is 0 if not touched, overriding slow decay for immediate off
  84:Thaumazein.cpp ****                  target_brightness = 0.0f; 
  85:Thaumazein.cpp ****             }
  86:Thaumazein.cpp ****             // Use the smoothed value, but clamp near zero if not touched
  87:Thaumazein.cpp ****             current_smoothed_brightness = pad_led_levels[ledIdx];
  88:Thaumazein.cpp ****             if (!padTouched && current_smoothed_brightness < 0.01f) {
  89:Thaumazein.cpp ****                 current_smoothed_brightness = 0.0f; // Snap to zero when close and untouched
  90:Thaumazein.cpp ****             }
  91:Thaumazein.cpp **** 
  92:Thaumazein.cpp ****             // Arp blink can still override to full bright temporarily even if ARP is off
  93:Thaumazein.cpp ****             if(blink) current_smoothed_brightness = 1.0f; 
  94:Thaumazein.cpp ****         }
ARM GAS  /var/folders/9s/8rp0_f2s1n31qbztm3b5_fdh0000gn/T//cckLE3ug.s 			page 18


  95:Thaumazein.cpp **** 
  96:Thaumazein.cpp ****         // --- New Quantization & Hysteresis Logic ---
  97:Thaumazein.cpp ****         const float step = 1.0f / 8.0f; // Keep 8 steps
 516              		.loc 1 97 9 is_stmt 1 view .LVU151
  98:Thaumazein.cpp ****         // Ensure smoothed brightness is clamped before quantization
  99:Thaumazein.cpp ****         current_smoothed_brightness = daisysp::fmax(0.0f, daisysp::fmin(1.0f, current_smoothed_brig
 517              		.loc 1 99 9 view .LVU152
 518              	.LBB180:
 519              	.LBI180:
 520              		.file 6 "lib/DaisySP/Source/Utility/dsp.h"
   1:lib/DaisySP/Source/Utility/dsp.h **** /*
   2:lib/DaisySP/Source/Utility/dsp.h **** Copyright (c) 2020 Electrosmith, Corp, Emilie Gillet
   3:lib/DaisySP/Source/Utility/dsp.h **** 
   4:lib/DaisySP/Source/Utility/dsp.h **** Use of this source code is governed by an MIT-style
   5:lib/DaisySP/Source/Utility/dsp.h **** license that can be found in the LICENSE file or at
   6:lib/DaisySP/Source/Utility/dsp.h **** https://opensource.org/licenses/MIT.
   7:lib/DaisySP/Source/Utility/dsp.h **** */
   8:lib/DaisySP/Source/Utility/dsp.h **** 
   9:lib/DaisySP/Source/Utility/dsp.h **** /** Helpful defines, functions, and other utilities for use in/with daisysp modules.
  10:lib/DaisySP/Source/Utility/dsp.h **** */
  11:lib/DaisySP/Source/Utility/dsp.h **** #pragma once
  12:lib/DaisySP/Source/Utility/dsp.h **** #ifndef DSY_CORE_DSP
  13:lib/DaisySP/Source/Utility/dsp.h **** #define DSY_CORE_DSP
  14:lib/DaisySP/Source/Utility/dsp.h **** #include <cassert>
  15:lib/DaisySP/Source/Utility/dsp.h **** #include <cstdint>
  16:lib/DaisySP/Source/Utility/dsp.h **** #include <random>
  17:lib/DaisySP/Source/Utility/dsp.h **** #include <cmath>
  18:lib/DaisySP/Source/Utility/dsp.h **** 
  19:lib/DaisySP/Source/Utility/dsp.h **** /** PIs
  20:lib/DaisySP/Source/Utility/dsp.h **** */
  21:lib/DaisySP/Source/Utility/dsp.h **** #define PI_F 3.1415927410125732421875f
  22:lib/DaisySP/Source/Utility/dsp.h **** #define TWOPI_F (2.0f * PI_F)
  23:lib/DaisySP/Source/Utility/dsp.h **** #define HALFPI_F (PI_F * 0.5f)
  24:lib/DaisySP/Source/Utility/dsp.h **** #define DSY_MIN(in, mn) (in < mn ? in : mn)
  25:lib/DaisySP/Source/Utility/dsp.h **** #define DSY_MAX(in, mx) (in > mx ? in : mx)
  26:lib/DaisySP/Source/Utility/dsp.h **** #define DSY_CLAMP(in, mn, mx) (DSY_MIN(DSY_MAX(in, mn), mx))
  27:lib/DaisySP/Source/Utility/dsp.h **** #define DSY_COUNTOF(_arr) (sizeof(_arr) / sizeof(_arr[0]))
  28:lib/DaisySP/Source/Utility/dsp.h **** 
  29:lib/DaisySP/Source/Utility/dsp.h **** namespace daisysp
  30:lib/DaisySP/Source/Utility/dsp.h **** {
  31:lib/DaisySP/Source/Utility/dsp.h **** //Avoids division for random floats. e.g. rand() * kRandFrac
  32:lib/DaisySP/Source/Utility/dsp.h **** static constexpr float kRandFrac = 1.f / (float)RAND_MAX;
  33:lib/DaisySP/Source/Utility/dsp.h **** 
  34:lib/DaisySP/Source/Utility/dsp.h **** //Convert from semitones to other units. e.g. 2 ^ (kOneTwelfth * x)
  35:lib/DaisySP/Source/Utility/dsp.h **** static constexpr float kOneTwelfth = 1.f / 12.f;
  36:lib/DaisySP/Source/Utility/dsp.h **** 
  37:lib/DaisySP/Source/Utility/dsp.h **** /** efficient floating point min/max
  38:lib/DaisySP/Source/Utility/dsp.h **** c/o stephen mccaul
  39:lib/DaisySP/Source/Utility/dsp.h **** */
  40:lib/DaisySP/Source/Utility/dsp.h **** inline float fmax(float a, float b)
  41:lib/DaisySP/Source/Utility/dsp.h **** {
  42:lib/DaisySP/Source/Utility/dsp.h ****     float r;
  43:lib/DaisySP/Source/Utility/dsp.h **** #ifdef __arm__
  44:lib/DaisySP/Source/Utility/dsp.h ****     asm("vmaxnm.f32 %[d], %[n], %[m]" : [d] "=t"(r) : [n] "t"(a), [m] "t"(b) :);
  45:lib/DaisySP/Source/Utility/dsp.h **** #else
  46:lib/DaisySP/Source/Utility/dsp.h ****     r = (a > b) ? a : b;
  47:lib/DaisySP/Source/Utility/dsp.h **** #endif // __arm__
ARM GAS  /var/folders/9s/8rp0_f2s1n31qbztm3b5_fdh0000gn/T//cckLE3ug.s 			page 19


  48:lib/DaisySP/Source/Utility/dsp.h ****     return r;
  49:lib/DaisySP/Source/Utility/dsp.h **** }
  50:lib/DaisySP/Source/Utility/dsp.h **** 
  51:lib/DaisySP/Source/Utility/dsp.h **** inline float fmin(float a, float b)
 521              		.loc 6 51 14 view .LVU153
 522              	.LBB181:
  52:lib/DaisySP/Source/Utility/dsp.h **** {
  53:lib/DaisySP/Source/Utility/dsp.h ****     float r;
 523              		.loc 6 53 5 view .LVU154
  54:lib/DaisySP/Source/Utility/dsp.h **** #ifdef __arm__
  55:lib/DaisySP/Source/Utility/dsp.h ****     asm("vminnm.f32 %[d], %[n], %[m]" : [d] "=t"(r) : [n] "t"(a), [m] "t"(b) :);
 524              		.loc 6 55 5 view .LVU155
 525              	.LBE181:
 526              	.LBE180:
 100:Thaumazein.cpp ****         float ideal_quant = roundf(current_smoothed_brightness / step) * step;
 527              		.loc 1 100 35 is_stmt 0 view .LVU156
 528 00a2 B2EE007A 		vmov.f32	s14, #8.0e+0
 101:Thaumazein.cpp ****         float current_quant = pad_led_prev_quant[ledIdx]; // Get the currently displayed level
 529              		.loc 1 101 15 view .LVU157
 530 00a6 1AED010A 		vldr.32	s0, [r10, #-4]
 100:Thaumazein.cpp ****         float ideal_quant = roundf(current_smoothed_brightness / step) * step;
 531              		.loc 1 100 15 view .LVU158
 532 00aa F4EE006A 		vmov.f32	s13, #1.25e-1
 533              	.LBB183:
 534              	.LBB182:
 535              		.loc 6 55 5 view .LVU159
 536              		.syntax unified
 537              	@ 55 "lib/DaisySP/Source/Utility/dsp.h" 1
 538 00ae C8FE677A 		vminnm.f32 s15, s16, s15
 539              	@ 0 "" 2
 540              	.LVL34:
  56:lib/DaisySP/Source/Utility/dsp.h **** #else
  57:lib/DaisySP/Source/Utility/dsp.h ****     r = (a < b) ? a : b;
  58:lib/DaisySP/Source/Utility/dsp.h **** #endif // __arm__
  59:lib/DaisySP/Source/Utility/dsp.h ****     return r;
 541              		.loc 6 59 5 is_stmt 1 view .LVU160
 542              		.loc 6 59 5 is_stmt 0 view .LVU161
 543              		.thumb
 544              		.syntax unified
 545              	.LBE182:
 546              	.LBE183:
 547              	.LBB184:
 548              	.LBI184:
  40:lib/DaisySP/Source/Utility/dsp.h **** {
 549              		.loc 6 40 14 is_stmt 1 view .LVU162
 550              	.LBB185:
  42:lib/DaisySP/Source/Utility/dsp.h **** #ifdef __arm__
 551              		.loc 6 42 5 view .LVU163
  44:lib/DaisySP/Source/Utility/dsp.h **** #else
 552              		.loc 6 44 5 view .LVU164
 553              		.syntax unified
 554              	@ 44 "lib/DaisySP/Source/Utility/dsp.h" 1
 555 00b2 C8FEA77A 		vmaxnm.f32 s15, s17, s15
 556              	@ 0 "" 2
 557              	.LVL35:
  48:lib/DaisySP/Source/Utility/dsp.h **** }
 558              		.loc 6 48 5 view .LVU165
ARM GAS  /var/folders/9s/8rp0_f2s1n31qbztm3b5_fdh0000gn/T//cckLE3ug.s 			page 20


  48:lib/DaisySP/Source/Utility/dsp.h **** }
 559              		.loc 6 48 5 is_stmt 0 view .LVU166
 560              		.thumb
 561              		.syntax unified
 562              	.LBE185:
 563              	.LBE184:
 100:Thaumazein.cpp ****         float current_quant = pad_led_prev_quant[ledIdx]; // Get the currently displayed level
 564              		.loc 1 100 9 is_stmt 1 view .LVU167
 100:Thaumazein.cpp ****         float current_quant = pad_led_prev_quant[ledIdx]; // Get the currently displayed level
 565              		.loc 1 100 35 is_stmt 0 view .LVU168
 566 00b6 27EE877A 		vmul.f32	s14, s15, s14
 567 00ba B8FE477A 		vrinta.f32	s14, s14
 100:Thaumazein.cpp ****         float current_quant = pad_led_prev_quant[ledIdx]; // Get the currently displayed level
 568              		.loc 1 100 15 view .LVU169
 569 00be 27EE267A 		vmul.f32	s14, s14, s13
 570              	.LVL36:
 571              		.loc 1 101 9 is_stmt 1 view .LVU170
 102:Thaumazein.cpp **** 
 103:Thaumazein.cpp ****         if (ideal_quant > current_quant) {
 572              		.loc 1 103 9 view .LVU171
 573              	.LBB186:
 574 00c2 B4EEC07A 		vcmpe.f32	s14, s0
 575 00c6 F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 576 00ca 6ADC     		bgt	.L30
 577              	.LBE186:
 578              	.LBE167:
 579              	.LBE166:
 104:Thaumazein.cpp ****             // If pressure/smoothed value increases to a higher step, update immediately
 105:Thaumazein.cpp ****             current_quant = ideal_quant;
 106:Thaumazein.cpp ****         } else if (ideal_quant < current_quant) {
 580              		.loc 1 106 16 view .LVU172
 581              	.LBB203:
 582              	.LBB199:
 583              	.LBB189:
 584              	.LBB187:
 585 00cc 07D5     		bpl	.L21
 586              	.LBB188:
 107:Thaumazein.cpp ****             // If pressure/smoothed value suggests a lower step...
 108:Thaumazein.cpp ****             // Only decrease if the smoothed value drops below the lower threshold of the current s
 109:Thaumazein.cpp ****             float downward_threshold = current_quant - step; 
 587              		.loc 1 109 13 view .LVU173
 588              	.LVL37:
 110:Thaumazein.cpp ****             if (current_smoothed_brightness < downward_threshold) {
 589              		.loc 1 110 13 view .LVU174
 109:Thaumazein.cpp ****             if (current_smoothed_brightness < downward_threshold) {
 590              		.loc 1 109 19 is_stmt 0 view .LVU175
 591 00ce 70EE666A 		vsub.f32	s13, s0, s13
 592              	.LVL38:
 111:Thaumazein.cpp ****                 // Smoothed value is clearly lower, move down to the ideal lower step
 112:Thaumazein.cpp ****                 current_quant = ideal_quant;
 593              		.loc 1 112 31 view .LVU176
 594 00d2 F4EE676A 		vcmp.f32	s13, s15
 595 00d6 F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 596 00da 37FE000A 		vselgt.f32	s0, s14, s0
 597              	.LVL39:
 598              	.L21:
 599              		.loc 1 112 31 view .LVU177
ARM GAS  /var/folders/9s/8rp0_f2s1n31qbztm3b5_fdh0000gn/T//cckLE3ug.s 			page 21


 600              	.LBE188:
 601              	.LBE187:
 602              	.LBE189:
 113:Thaumazein.cpp ****             }
 114:Thaumazein.cpp ****             // Else: smoothed value is still near the current step, hold the brightness steady.
 115:Thaumazein.cpp ****         }
 116:Thaumazein.cpp ****         // If ideal_quant == current_quant, current_quant remains unchanged.
 117:Thaumazein.cpp **** 
 118:Thaumazein.cpp ****         // Clamp final value just in case math went weird
 119:Thaumazein.cpp ****         current_quant = daisysp::fmax(0.0f, daisysp::fmin(1.0f, current_quant));
 603              		.loc 1 119 9 is_stmt 1 discriminator 2 view .LVU178
 604              	.LBB190:
 605              	.LBI190:
  51:lib/DaisySP/Source/Utility/dsp.h **** {
 606              		.loc 6 51 14 discriminator 2 view .LVU179
 607              	.LBB191:
  53:lib/DaisySP/Source/Utility/dsp.h **** #ifdef __arm__
 608              		.loc 6 53 5 discriminator 2 view .LVU180
  55:lib/DaisySP/Source/Utility/dsp.h **** #else
 609              		.loc 6 55 5 discriminator 2 view .LVU181
 610 00de 5D4B     		ldr	r3, .L45+32
 611 00e0 1C20     		movs	r0, #28
 612              		.syntax unified
 613              	@ 55 "lib/DaisySP/Source/Utility/dsp.h" 1
 614 00e2 88FE400A 		vminnm.f32 s0, s16, s0
 615              	@ 0 "" 2
 616              	.LVL40:
 617              		.loc 6 59 5 discriminator 2 view .LVU182
 618              		.loc 6 59 5 is_stmt 0 discriminator 2 view .LVU183
 619              		.thumb
 620              		.syntax unified
 621              	.LBE191:
 622              	.LBE190:
 623              	.LBB192:
 624              	.LBI192:
  40:lib/DaisySP/Source/Utility/dsp.h **** {
 625              		.loc 6 40 14 is_stmt 1 discriminator 2 view .LVU184
 626              	.LBB193:
  42:lib/DaisySP/Source/Utility/dsp.h **** #ifdef __arm__
 627              		.loc 6 42 5 discriminator 2 view .LVU185
  44:lib/DaisySP/Source/Utility/dsp.h **** #else
 628              		.loc 6 44 5 discriminator 2 view .LVU186
 629 00e6 00FB0530 		mla	r0, r0, r5, r3
 630              	.LBE193:
 631              	.LBE192:
 632              	.LBE199:
  60:Thaumazein.cpp ****         int ledIdx = 11 - i;  // pad i maps to LED[11-i]
 633              		.loc 1 60 22 is_stmt 0 discriminator 2 view .LVU187
 634 00ea 013D     		subs	r5, r5, #1
 635              	.LVL41:
 636              	.LBB200:
 637              	.LBB195:
 638              	.LBB194:
  44:lib/DaisySP/Source/Utility/dsp.h **** #else
 639              		.loc 6 44 5 discriminator 2 view .LVU188
 640              		.syntax unified
 641              	@ 44 "lib/DaisySP/Source/Utility/dsp.h" 1
ARM GAS  /var/folders/9s/8rp0_f2s1n31qbztm3b5_fdh0000gn/T//cckLE3ug.s 			page 22


 642 00ec 88FE800A 		vmaxnm.f32 s0, s17, s0
 643              	@ 0 "" 2
 644              	.LVL42:
  48:lib/DaisySP/Source/Utility/dsp.h **** }
 645              		.loc 6 48 5 is_stmt 1 discriminator 2 view .LVU189
  48:lib/DaisySP/Source/Utility/dsp.h **** }
 646              		.loc 6 48 5 is_stmt 0 discriminator 2 view .LVU190
 647              		.thumb
 648              		.syntax unified
 649              	.LBE194:
 650              	.LBE195:
 120:Thaumazein.cpp **** 
 121:Thaumazein.cpp ****         // Store the updated level for the next iteration's comparison
 122:Thaumazein.cpp ****         pad_led_prev_quant[ledIdx] = current_quant;
 651              		.loc 1 122 9 is_stmt 1 discriminator 2 view .LVU191
 123:Thaumazein.cpp **** 
 124:Thaumazein.cpp ****         // Set the LED brightness
 125:Thaumazein.cpp ****         touch_leds[ledIdx].Set(current_quant);
 652              		.loc 1 125 31 is_stmt 0 discriminator 2 view .LVU192
 653 00f0 0190     		str	r0, [sp, #4]
 654              	.LBE200:
  60:Thaumazein.cpp ****         int ledIdx = 11 - i;  // pad i maps to LED[11-i]
 655              		.loc 1 60 22 discriminator 2 view .LVU193
 656 00f2 043C     		subs	r4, r4, #4
 657              	.LBB201:
 122:Thaumazein.cpp **** 
 658              		.loc 1 122 36 discriminator 2 view .LVU194
 659 00f4 2AED010A 		vstmdb.32	r10!, {s0}
 660              		.loc 1 125 9 is_stmt 1 discriminator 2 view .LVU195
 661              		.loc 1 125 31 is_stmt 0 discriminator 2 view .LVU196
 662 00f8 FFF7FEFF 		bl	_ZN5daisy3Led3SetEf
 663              	.LVL43:
 126:Thaumazein.cpp ****         touch_leds[ledIdx].Update();
 664              		.loc 1 126 9 is_stmt 1 discriminator 2 view .LVU197
 665              		.loc 1 126 34 is_stmt 0 discriminator 2 view .LVU198
 666 00fc 0198     		ldr	r0, [sp, #4]
 667 00fe FFF7FEFF 		bl	_ZN5daisy3Led6UpdateEv
 668              	.LVL44:
 669              	.LBE201:
  60:Thaumazein.cpp ****         int ledIdx = 11 - i;  // pad i maps to LED[11-i]
 670              		.loc 1 60 5 is_stmt 1 discriminator 2 view .LVU199
  60:Thaumazein.cpp ****         int ledIdx = 11 - i;  // pad i maps to LED[11-i]
 671              		.loc 1 60 22 discriminator 2 view .LVU200
 672 0102 6A1C     		adds	r2, r5, #1
 673 0104 B4D1     		bne	.L24
 674              	.LBE203:
 127:Thaumazein.cpp ****     }
 128:Thaumazein.cpp **** 
 129:Thaumazein.cpp ****     if (touched == 0) {
 675              		.loc 1 129 5 view .LVU201
 676 0106 002E     		cmp	r6, #0
 677 0108 4ED1     		bne	.L31
 130:Thaumazein.cpp ****         // Optionally decay the control value smoothly to 0 when no pads are touched
 131:Thaumazein.cpp ****         touch_cv_value = touch_cv_value * 0.95f; 
 678              		.loc 1 131 9 view .LVU202
 679              		.loc 1 131 26 is_stmt 0 view .LVU203
 680 010a 534B     		ldr	r3, .L45+36
ARM GAS  /var/folders/9s/8rp0_f2s1n31qbztm3b5_fdh0000gn/T//cckLE3ug.s 			page 23


 681              		.loc 1 131 41 view .LVU204
 682 010c 9FED537A 		vldr.32	s14, .L45+40
 683              		.loc 1 131 26 view .LVU205
 684 0110 D3ED007A 		vldr.32	s15, [r3]
 685              		.loc 1 131 41 view .LVU206
 686 0114 67EE877A 		vmul.f32	s15, s15, s14
 687              		.loc 1 131 24 view .LVU207
 688 0118 C3ED007A 		vstr.32	s15, [r3]
 132:Thaumazein.cpp ****         return;
 689              		.loc 1 132 9 is_stmt 1 view .LVU208
 690              	.LVL45:
 691              	.L12:
 133:Thaumazein.cpp ****     }
 134:Thaumazein.cpp **** 
 135:Thaumazein.cpp ****     float total_deviation = 0.0f;
 136:Thaumazein.cpp ****     int touched_count = 0;
 137:Thaumazein.cpp **** 
 138:Thaumazein.cpp ****     // Iterate through all pads
 139:Thaumazein.cpp ****     for (int i = 0; i < 12; i++) {
 140:Thaumazein.cpp ****         if (touched & (1 << i)) {
 141:Thaumazein.cpp ****             // Get capacitance deviation for this touched pad
 142:Thaumazein.cpp ****             int16_t deviation = touch_sensor.GetBaselineDeviation(i);
 143:Thaumazein.cpp ****             total_deviation += deviation;
 144:Thaumazein.cpp ****             touched_count++;
 145:Thaumazein.cpp ****         }
 146:Thaumazein.cpp ****     }
 147:Thaumazein.cpp **** 
 148:Thaumazein.cpp ****     float average_deviation = 0.0f;
 149:Thaumazein.cpp ****     if (touched_count > 0) {
 150:Thaumazein.cpp ****         average_deviation = total_deviation / touched_count;
 151:Thaumazein.cpp ****     }
 152:Thaumazein.cpp **** 
 153:Thaumazein.cpp ****     // Normalize to 0.0-1.0 range with adjustable sensitivity
 154:Thaumazein.cpp ****     // Consider recalibrating sensitivity if needed for average pressure
 155:Thaumazein.cpp ****     float normalized_value = daisysp::fmax(0.0f, daisysp::fmin(1.0f, average_deviation / sensitivit
 156:Thaumazein.cpp **** 
 157:Thaumazein.cpp ****     // Apply curve for better control response (squared curve feels more natural)
 158:Thaumazein.cpp ****     normalized_value = normalized_value * normalized_value;
 159:Thaumazein.cpp **** 
 160:Thaumazein.cpp ****     // Remove the position component - control is now based purely on average pressure
 161:Thaumazein.cpp ****     // float position_value = highest_pad / 11.0f; // Removed
 162:Thaumazein.cpp ****     // float position_weight = 0.7f;              // Removed
 163:Thaumazein.cpp ****     // float combined_value = position_value * position_weight + normalized_value * (1.0f - positio
 164:Thaumazein.cpp ****     float combined_value = normalized_value; // Use normalized average pressure directly
 165:Thaumazein.cpp **** 
 166:Thaumazein.cpp ****     // Apply adaptive smoothing - more smoothing for small changes, less for big changes
 167:Thaumazein.cpp ****     float change = fabsf(combined_value - touch_cv_value);
 168:Thaumazein.cpp ****     float smoothing = daisysp::fmax(0.5f, 0.95f - change * 2.0f); // 0.5-0.95 smoothing range
 169:Thaumazein.cpp **** 
 170:Thaumazein.cpp ****     // Update the shared volatile variable
 171:Thaumazein.cpp ****     touch_cv_value = touch_cv_value * smoothing + combined_value * (1.0f - smoothing);
 172:Thaumazein.cpp **** }
 692              		.loc 1 172 1 is_stmt 0 view .LVU209
 693 011c 09B0     		add	sp, sp, #36
 694              		.cfi_remember_state
 695              		.cfi_def_cfa_offset 52
 696              		@ sp needed
ARM GAS  /var/folders/9s/8rp0_f2s1n31qbztm3b5_fdh0000gn/T//cckLE3ug.s 			page 24


 697 011e BDEC048B 		vldm	sp!, {d8-d9}
 698              		.cfi_restore 82
 699              		.cfi_restore 83
 700              		.cfi_restore 80
 701              		.cfi_restore 81
 702              		.cfi_def_cfa_offset 36
 703 0122 BDE8F08F 		pop	{r4, r5, r6, r7, r8, r9, r10, fp, pc}
 704              	.LVL46:
 705              	.L14:
 706              		.cfi_restore_state
 707              	.LBB204:
 708              	.LBB202:
 709              	.LBB196:
 710              	.LBB169:
  75:Thaumazein.cpp ****                 int16_t deviation = touch_sensor.GetBaselineDeviation(i);
 711              		.loc 1 75 13 is_stmt 1 view .LVU210
 712              	.LBE169:
 713              	.LBE196:
  62:Thaumazein.cpp ****         bool blink     = (now - arp_led_timestamps[ledIdx]) < ARP_LED_DURATION_MS;
 714              		.loc 1 62 48 is_stmt 0 view .LVU211
 715 0126 46FA01F3 		asr	r3, r6, r1
 716              	.LVL47:
  62:Thaumazein.cpp ****         bool blink     = (now - arp_led_timestamps[ledIdx]) < ARP_LED_DURATION_MS;
 717              		.loc 1 62 48 view .LVU212
 718 012a 9FED4D9A 		vldr.32	s18, .L45+44
 719              	.LBB197:
 720              	.LBB179:
 721              	.LBB170:
  75:Thaumazein.cpp ****                 int16_t deviation = touch_sensor.GetBaselineDeviation(i);
 722              		.loc 1 75 13 view .LVU213
 723 012e 13F0010B 		ands	fp, r3, #1
 724 0132 31D0     		beq	.L17
 725              	.LBB171:
  76:Thaumazein.cpp ****                 target_brightness = daisysp::fmax(0.0f, daisysp::fmin(1.0f, deviation / sensitivity
 726              		.loc 1 76 17 is_stmt 1 view .LVU214
  76:Thaumazein.cpp ****                 target_brightness = daisysp::fmax(0.0f, daisysp::fmin(1.0f, deviation / sensitivity
 727              		.loc 1 76 70 is_stmt 0 view .LVU215
 728 0134 C9B2     		uxtb	r1, r1
 729              	.LVL48:
  76:Thaumazein.cpp ****                 target_brightness = daisysp::fmax(0.0f, daisysp::fmin(1.0f, deviation / sensitivity
 730              		.loc 1 76 70 view .LVU216
 731 0136 3F48     		ldr	r0, .L45
 732 0138 FFF7FEFF 		bl	_ZN6Mpr12120GetBaselineDeviationEh
 733              	.LVL49:
  77:Thaumazein.cpp ****                 // Apply smoothing to the target brightness
 734              		.loc 1 77 17 is_stmt 1 view .LVU217
 735              	.LBB172:
 736              	.LBI172:
  51:lib/DaisySP/Source/Utility/dsp.h **** {
 737              		.loc 6 51 14 view .LVU218
 738              	.LBB173:
  53:lib/DaisySP/Source/Utility/dsp.h **** #ifdef __arm__
 739              		.loc 6 53 5 view .LVU219
  55:lib/DaisySP/Source/Utility/dsp.h **** #else
 740              		.loc 6 55 5 view .LVU220
 741              	.LBE173:
 742              	.LBE172:
ARM GAS  /var/folders/9s/8rp0_f2s1n31qbztm3b5_fdh0000gn/T//cckLE3ug.s 			page 25


  77:Thaumazein.cpp ****                 // Apply smoothing to the target brightness
 743              		.loc 1 77 50 is_stmt 0 view .LVU221
 744 013c 07EE900A 		vmov	s15, r0	@ int
 745 0140 DFED486A 		vldr.32	s13, .L45+48
 746 0144 B8EEE77A 		vcvt.f32.s32	s14, s15
 747 0148 C7EE267A 		vdiv.f32	s15, s14, s13
  79:Thaumazein.cpp ****             } else {
 748              		.loc 1 79 102 view .LVU222
 749 014c 9FED467A 		vldr.32	s14, .L45+52
 750              	.LBB175:
 751              	.LBB174:
  55:lib/DaisySP/Source/Utility/dsp.h **** #else
 752              		.loc 6 55 5 view .LVU223
 753              		.syntax unified
 754              	@ 55 "lib/DaisySP/Source/Utility/dsp.h" 1
 755 0150 C8FE677A 		vminnm.f32 s15, s16, s15
 756              	@ 0 "" 2
 757              	.LVL50:
 758              		.loc 6 59 5 is_stmt 1 view .LVU224
 759              		.loc 6 59 5 is_stmt 0 view .LVU225
 760              		.thumb
 761              		.syntax unified
 762              	.LBE174:
 763              	.LBE175:
 764              	.LBB176:
 765              	.LBI176:
  40:lib/DaisySP/Source/Utility/dsp.h **** {
 766              		.loc 6 40 14 is_stmt 1 view .LVU226
 767              	.LBB177:
  42:lib/DaisySP/Source/Utility/dsp.h **** #ifdef __arm__
 768              		.loc 6 42 5 view .LVU227
  44:lib/DaisySP/Source/Utility/dsp.h **** #else
 769              		.loc 6 44 5 view .LVU228
 770              		.syntax unified
 771              	@ 44 "lib/DaisySP/Source/Utility/dsp.h" 1
 772 0154 C8FEA77A 		vmaxnm.f32 s15, s17, s15
 773              	@ 0 "" 2
 774              	.LVL51:
  48:lib/DaisySP/Source/Utility/dsp.h **** }
 775              		.loc 6 48 5 view .LVU229
  48:lib/DaisySP/Source/Utility/dsp.h **** }
 776              		.loc 6 48 5 is_stmt 0 view .LVU230
 777              		.thumb
 778              		.syntax unified
 779              	.LBE177:
 780              	.LBE176:
  79:Thaumazein.cpp ****             } else {
 781              		.loc 1 79 17 is_stmt 1 view .LVU231
  79:Thaumazein.cpp ****             } else {
 782              		.loc 1 79 102 is_stmt 0 view .LVU232
 783 0158 67EE877A 		vmul.f32	s15, s15, s14
 784              	.LVL52:
  79:Thaumazein.cpp ****             } else {
 785              		.loc 1 79 82 view .LVU233
 786 015c 94ED0B7A 		vldr.32	s14, [r4, #44]
 787 0160 E7EE097A 		vfma.f32	s15, s14, s18
 788              	.LVL53:
ARM GAS  /var/folders/9s/8rp0_f2s1n31qbztm3b5_fdh0000gn/T//cckLE3ug.s 			page 26


 789              	.L44:
  79:Thaumazein.cpp ****             } else {
 790              		.loc 1 79 82 view .LVU234
 791              	.LBE171:
  82:Thaumazein.cpp ****                  // Ensure target is 0 if not touched, overriding slow decay for immediate off
 792              		.loc 1 82 41 view .LVU235
 793 0164 C4ED0B7A 		vstr.32	s15, [r4, #44]
  84:Thaumazein.cpp ****             }
 794              		.loc 1 84 18 is_stmt 1 view .LVU236
 795              	.LVL54:
  84:Thaumazein.cpp ****             }
 796              		.loc 1 84 18 is_stmt 0 view .LVU237
 797              	.LBE170:
  87:Thaumazein.cpp ****             if (!padTouched && current_smoothed_brightness < 0.01f) {
 798              		.loc 1 87 13 is_stmt 1 view .LVU238
  87:Thaumazein.cpp ****             if (!padTouched && current_smoothed_brightness < 0.01f) {
 799              		.loc 1 87 41 is_stmt 0 view .LVU239
 800 0168 D4ED0B7A 		vldr.32	s15, [r4, #44]
 801              	.LVL55:
  88:Thaumazein.cpp ****                 current_smoothed_brightness = 0.0f; // Snap to zero when close and untouched
 802              		.loc 1 88 13 is_stmt 1 view .LVU240
 803 016c BBF1000F 		cmp	fp, #0
 804 0170 0AD1     		bne	.L19
  89:Thaumazein.cpp ****             }
 805              		.loc 1 89 45 is_stmt 0 discriminator 1 view .LVU241
 806 0172 9FED3D7A 		vldr.32	s14, .L45+52
 807 0176 F4EE477A 		vcmp.f32	s15, s14
 808 017a 9FED347A 		vldr.32	s14, .L45+24
 809 017e F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 810 0182 48BF     		it	mi
 811 0184 F0EE477A 		vmovmi.f32	s15, s14
 812              	.LVL56:
 813              	.L19:
  93:Thaumazein.cpp ****         }
 814              		.loc 1 93 13 is_stmt 1 view .LVU242
  93:Thaumazein.cpp ****         }
 815              		.loc 1 93 51 is_stmt 0 view .LVU243
 816 0188 019B     		ldr	r3, [sp, #4]
 817 018a B7EE007A 		vmov.f32	s14, #1.0e+0
 818 018e 9F42     		cmp	r7, r3
 819 0190 38BF     		it	cc
 820 0192 F0EE477A 		vmovcc.f32	s15, s14
 821              	.LVL57:
  93:Thaumazein.cpp ****         }
 822              		.loc 1 93 51 view .LVU244
 823 0196 84E7     		b	.L16
 824              	.LVL58:
 825              	.L17:
 826              	.LBB178:
  82:Thaumazein.cpp ****                  // Ensure target is 0 if not touched, overriding slow decay for immediate off
 827              		.loc 1 82 18 is_stmt 1 view .LVU245
  82:Thaumazein.cpp ****                  // Ensure target is 0 if not touched, overriding slow decay for immediate off
 828              		.loc 1 82 66 is_stmt 0 view .LVU246
 829 0198 D4ED0B7A 		vldr.32	s15, [r4, #44]
 830 019c 67EE897A 		vmul.f32	s15, s15, s18
 831 01a0 E0E7     		b	.L44
 832              	.LVL59:
ARM GAS  /var/folders/9s/8rp0_f2s1n31qbztm3b5_fdh0000gn/T//cckLE3ug.s 			page 27


 833              	.L30:
  82:Thaumazein.cpp ****                  // Ensure target is 0 if not touched, overriding slow decay for immediate off
 834              		.loc 1 82 66 view .LVU247
 835              	.LBE178:
 836              	.LBE179:
 837              	.LBE197:
 838              	.LBB198:
 105:Thaumazein.cpp ****         } else if (ideal_quant < current_quant) {
 839              		.loc 1 105 27 view .LVU248
 840 01a2 B0EE470A 		vmov.f32	s0, s14
 841              	.LVL60:
 105:Thaumazein.cpp ****         } else if (ideal_quant < current_quant) {
 842              		.loc 1 105 27 view .LVU249
 843 01a6 9AE7     		b	.L21
 844              	.LVL61:
 845              	.L31:
 105:Thaumazein.cpp ****         } else if (ideal_quant < current_quant) {
 846              		.loc 1 105 27 view .LVU250
 847              	.LBE198:
 848              	.LBE202:
 849              	.LBE204:
 850              	.LBB205:
 139:Thaumazein.cpp ****         if (touched & (1 << i)) {
 851              		.loc 1 139 14 view .LVU251
 852 01a8 0025     		movs	r5, #0
 853              	.LBE205:
 135:Thaumazein.cpp ****     int touched_count = 0;
 854              		.loc 1 135 11 view .LVU252
 855 01aa 9FED289A 		vldr.32	s18, .L45+24
 136:Thaumazein.cpp **** 
 856              		.loc 1 136 9 view .LVU253
 857 01ae 2C46     		mov	r4, r5
 858              	.LVL62:
 859              	.L25:
 140:Thaumazein.cpp ****             // Get capacitance deviation for this touched pad
 860              		.loc 1 140 9 is_stmt 1 view .LVU254
 861              	.LBB208:
 862              	.LBB206:
 140:Thaumazein.cpp ****             // Get capacitance deviation for this touched pad
 863              		.loc 1 140 21 is_stmt 0 view .LVU255
 864 01b0 46FA05F3 		asr	r3, r6, r5
 140:Thaumazein.cpp ****             // Get capacitance deviation for this touched pad
 865              		.loc 1 140 9 view .LVU256
 866 01b4 DB07     		lsls	r3, r3, #31
 867 01b6 0AD5     		bpl	.L27
 868              	.LBB207:
 142:Thaumazein.cpp ****             total_deviation += deviation;
 869              		.loc 1 142 13 is_stmt 1 view .LVU257
 142:Thaumazein.cpp ****             total_deviation += deviation;
 870              		.loc 1 142 66 is_stmt 0 view .LVU258
 871 01b8 E9B2     		uxtb	r1, r5
 872 01ba 1E48     		ldr	r0, .L45
 873 01bc FFF7FEFF 		bl	_ZN6Mpr12120GetBaselineDeviationEh
 874              	.LVL63:
 143:Thaumazein.cpp ****             touched_count++;
 875              		.loc 1 143 13 is_stmt 1 view .LVU259
 143:Thaumazein.cpp ****             touched_count++;
ARM GAS  /var/folders/9s/8rp0_f2s1n31qbztm3b5_fdh0000gn/T//cckLE3ug.s 			page 28


 876              		.loc 1 143 29 is_stmt 0 view .LVU260
 877 01c0 07EE900A 		vmov	s15, r0	@ int
 144:Thaumazein.cpp ****         }
 878              		.loc 1 144 26 view .LVU261
 879 01c4 0134     		adds	r4, r4, #1
 880              	.LVL64:
 143:Thaumazein.cpp ****             touched_count++;
 881              		.loc 1 143 29 view .LVU262
 882 01c6 F8EEE77A 		vcvt.f32.s32	s15, s15
 883 01ca 39EE279A 		vadd.f32	s18, s18, s15
 884              	.LVL65:
 144:Thaumazein.cpp ****         }
 885              		.loc 1 144 13 is_stmt 1 view .LVU263
 886              	.L27:
 144:Thaumazein.cpp ****         }
 887              		.loc 1 144 13 is_stmt 0 view .LVU264
 888              	.LBE207:
 889              	.LBE206:
 139:Thaumazein.cpp ****         if (touched & (1 << i)) {
 890              		.loc 1 139 5 is_stmt 1 discriminator 2 view .LVU265
 891 01ce 0135     		adds	r5, r5, #1
 892              	.LVL66:
 139:Thaumazein.cpp ****         if (touched & (1 << i)) {
 893              		.loc 1 139 23 discriminator 2 view .LVU266
 894 01d0 0C2D     		cmp	r5, #12
 895 01d2 EDD1     		bne	.L25
 139:Thaumazein.cpp ****         if (touched & (1 << i)) {
 896              		.loc 1 139 23 is_stmt 0 discriminator 2 view .LVU267
 897              	.LBE208:
 148:Thaumazein.cpp ****     if (touched_count > 0) {
 898              		.loc 1 148 5 is_stmt 1 view .LVU268
 899              	.LVL67:
 149:Thaumazein.cpp ****         average_deviation = total_deviation / touched_count;
 900              		.loc 1 149 5 view .LVU269
 901 01d4 5CB3     		cbz	r4, .L32
 150:Thaumazein.cpp ****     }
 902              		.loc 1 150 9 view .LVU270
 150:Thaumazein.cpp ****     }
 903              		.loc 1 150 45 is_stmt 0 view .LVU271
 904 01d6 07EE904A 		vmov	s15, r4	@ int
 905 01da F8EEE77A 		vcvt.f32.s32	s15, s15
 150:Thaumazein.cpp ****     }
 906              		.loc 1 150 27 view .LVU272
 907 01de 89EE277A 		vdiv.f32	s14, s18, s15
 908              	.LVL68:
 909              	.L28:
 155:Thaumazein.cpp **** 
 910              		.loc 1 155 5 is_stmt 1 view .LVU273
 911              	.LBB209:
 912              	.LBI209:
  51:lib/DaisySP/Source/Utility/dsp.h **** {
 913              		.loc 6 51 14 view .LVU274
 914              	.LBB210:
  53:lib/DaisySP/Source/Utility/dsp.h **** #ifdef __arm__
 915              		.loc 6 53 5 view .LVU275
  55:lib/DaisySP/Source/Utility/dsp.h **** #else
 916              		.loc 6 55 5 view .LVU276
ARM GAS  /var/folders/9s/8rp0_f2s1n31qbztm3b5_fdh0000gn/T//cckLE3ug.s 			page 29


 917              	.LBE210:
 918              	.LBE209:
 155:Thaumazein.cpp **** 
 919              		.loc 1 155 43 is_stmt 0 view .LVU277
 920 01e2 DFED206A 		vldr.32	s13, .L45+48
 167:Thaumazein.cpp ****     float smoothing = daisysp::fmax(0.5f, 0.95f - change * 2.0f); // 0.5-0.95 smoothing range
 921              		.loc 1 167 43 view .LVU278
 922 01e6 1C4B     		ldr	r3, .L45+36
 155:Thaumazein.cpp **** 
 923              		.loc 1 155 43 view .LVU279
 924 01e8 C7EE267A 		vdiv.f32	s15, s14, s13
 925              	.LVL69:
 168:Thaumazein.cpp **** 
 926              		.loc 1 168 36 view .LVU280
 927 01ec 9FED1B7A 		vldr.32	s14, .L45+40
 928              	.LVL70:
 929              	.LBB212:
 930              	.LBB211:
  55:lib/DaisySP/Source/Utility/dsp.h **** #else
 931              		.loc 6 55 5 view .LVU281
 932              		.syntax unified
 933              	@ 55 "lib/DaisySP/Source/Utility/dsp.h" 1
 934 01f0 C8FE677A 		vminnm.f32 s15, s16, s15
 935              	@ 0 "" 2
 936              	.LVL71:
 937              		.loc 6 59 5 is_stmt 1 view .LVU282
 938              		.loc 6 59 5 is_stmt 0 view .LVU283
 939              		.thumb
 940              		.syntax unified
 941              	.LBE211:
 942              	.LBE212:
 943              	.LBB213:
 944              	.LBI213:
  40:lib/DaisySP/Source/Utility/dsp.h **** {
 945              		.loc 6 40 14 is_stmt 1 view .LVU284
 946              	.LBB214:
  42:lib/DaisySP/Source/Utility/dsp.h **** #ifdef __arm__
 947              		.loc 6 42 5 view .LVU285
  44:lib/DaisySP/Source/Utility/dsp.h **** #else
 948              		.loc 6 44 5 view .LVU286
 949              		.syntax unified
 950              	@ 44 "lib/DaisySP/Source/Utility/dsp.h" 1
 951 01f4 C8FEA78A 		vmaxnm.f32 s17, s17, s15
 952              	@ 0 "" 2
 953              	.LVL72:
  48:lib/DaisySP/Source/Utility/dsp.h **** }
 954              		.loc 6 48 5 view .LVU287
  48:lib/DaisySP/Source/Utility/dsp.h **** }
 955              		.loc 6 48 5 is_stmt 0 view .LVU288
 956              		.thumb
 957              		.syntax unified
 958              	.LBE214:
 959              	.LBE213:
 158:Thaumazein.cpp **** 
 960              		.loc 1 158 5 is_stmt 1 view .LVU289
 167:Thaumazein.cpp ****     float smoothing = daisysp::fmax(0.5f, 0.95f - change * 2.0f); // 0.5-0.95 smoothing range
 961              		.loc 1 167 43 is_stmt 0 view .LVU290
ARM GAS  /var/folders/9s/8rp0_f2s1n31qbztm3b5_fdh0000gn/T//cckLE3ug.s 			page 30


 962 01f8 D3ED007A 		vldr.32	s15, [r3]
 158:Thaumazein.cpp **** 
 963              		.loc 1 158 22 view .LVU291
 964 01fc 68EEA88A 		vmul.f32	s17, s17, s17
 965              	.LVL73:
 164:Thaumazein.cpp **** 
 966              		.loc 1 164 5 is_stmt 1 view .LVU292
 167:Thaumazein.cpp ****     float smoothing = daisysp::fmax(0.5f, 0.95f - change * 2.0f); // 0.5-0.95 smoothing range
 967              		.loc 1 167 5 view .LVU293
 168:Thaumazein.cpp **** 
 968              		.loc 1 168 5 view .LVU294
 168:Thaumazein.cpp **** 
 969              		.loc 1 168 36 is_stmt 0 view .LVU295
 970 0200 F0EE006A 		vmov.f32	s13, #2.0e+0
 167:Thaumazein.cpp ****     float smoothing = daisysp::fmax(0.5f, 0.95f - change * 2.0f); // 0.5-0.95 smoothing range
 971              		.loc 1 167 41 view .LVU296
 972 0204 78EEE77A 		vsub.f32	s15, s17, s15
 973              	.LVL74:
 167:Thaumazein.cpp ****     float smoothing = daisysp::fmax(0.5f, 0.95f - change * 2.0f); // 0.5-0.95 smoothing range
 974              		.loc 1 167 57 view .LVU297
 975 0208 F0EEE77A 		vabs.f32	s15, s15
 976              	.LVL75:
 168:Thaumazein.cpp **** 
 977              		.loc 1 168 36 view .LVU298
 978 020c A7EEE67A 		vfms.f32	s14, s15, s13
 979              	.LVL76:
 980              	.LBB215:
 981              	.LBI215:
  40:lib/DaisySP/Source/Utility/dsp.h **** {
 982              		.loc 6 40 14 is_stmt 1 view .LVU299
 983              	.LBB216:
  42:lib/DaisySP/Source/Utility/dsp.h **** #ifdef __arm__
 984              		.loc 6 42 5 view .LVU300
  44:lib/DaisySP/Source/Utility/dsp.h **** #else
 985              		.loc 6 44 5 view .LVU301
 986 0210 F6EE007A 		vmov.f32	s15, #5.0e-1
 987              	.LVL77:
  44:lib/DaisySP/Source/Utility/dsp.h **** #else
 988              		.loc 6 44 5 is_stmt 0 view .LVU302
 989              		.syntax unified
 990              	@ 44 "lib/DaisySP/Source/Utility/dsp.h" 1
 991 0214 C7FE877A 		vmaxnm.f32 s15, s15, s14
 992              	@ 0 "" 2
 993              	.LVL78:
  48:lib/DaisySP/Source/Utility/dsp.h **** }
 994              		.loc 6 48 5 is_stmt 1 view .LVU303
  48:lib/DaisySP/Source/Utility/dsp.h **** }
 995              		.loc 6 48 5 is_stmt 0 view .LVU304
 996              		.thumb
 997              		.syntax unified
 998              	.LBE216:
 999              	.LBE215:
 171:Thaumazein.cpp **** }
 1000              		.loc 1 171 5 is_stmt 1 view .LVU305
 171:Thaumazein.cpp **** }
 1001              		.loc 1 171 74 is_stmt 0 view .LVU306
 1002 0218 38EE678A 		vsub.f32	s16, s16, s15
ARM GAS  /var/folders/9s/8rp0_f2s1n31qbztm3b5_fdh0000gn/T//cckLE3ug.s 			page 31


 171:Thaumazein.cpp **** }
 1003              		.loc 1 171 22 view .LVU307
 1004 021c 93ED007A 		vldr.32	s14, [r3]
 171:Thaumazein.cpp **** }
 1005              		.loc 1 171 66 view .LVU308
 1006 0220 28EE288A 		vmul.f32	s16, s16, s17
 171:Thaumazein.cpp **** }
 1007              		.loc 1 171 49 view .LVU309
 1008 0224 A7EE278A 		vfma.f32	s16, s14, s15
 171:Thaumazein.cpp **** }
 1009              		.loc 1 171 20 view .LVU310
 1010 0228 83ED008A 		vstr.32	s16, [r3]
 1011 022c 76E7     		b	.L12
 1012              	.LVL79:
 1013              	.L32:
 148:Thaumazein.cpp ****     if (touched_count > 0) {
 1014              		.loc 1 148 11 view .LVU311
 1015 022e 9FED077A 		vldr.32	s14, .L45+24
 1016 0232 D6E7     		b	.L28
 1017              	.L46:
 1018              		.align	2
 1019              	.L45:
 1020 0234 00000000 		.word	touch_sensor
 1021 0238 00000000 		.word	.LANCHOR0
 1022 023c 00000000 		.word	.LANCHOR1
 1023 0240 00000000 		.word	arp
 1024 0244 00000000 		.word	pad_led_levels
 1025 0248 00000000 		.word	arp_led_timestamps
 1026 024c 00000000 		.word	0
 1027 0250 00000000 		.word	ARP_LED_DURATION_MS
 1028 0254 00000000 		.word	touch_leds
 1029 0258 00000000 		.word	.LANCHOR2
 1030 025c 3333733F 		.word	1064514355
 1031 0260 A4707D3F 		.word	1065185444
 1032 0264 00001643 		.word	1125515264
 1033 0268 0AD7233C 		.word	1008981770
 1034 026c 30000000 		.word	pad_led_prev_quant+48
 1035              		.cfi_endproc
 1036              	.LFE5344:
 1038              		.section	.rodata.main.str1.1,"aMS",%progbits,1
 1039              	.LC9:
 1040 0000 484200   		.ascii	"HB\000"
 1041              		.section	.text.startup.main,"ax",%progbits
 1042              		.align	1
 1043              		.global	main
 1044              		.syntax unified
 1045              		.thumb
 1046              		.thumb_func
 1048              	main:
 1049              	.LFB5348:
 173:Thaumazein.cpp **** 
 174:Thaumazein.cpp **** int main(void) {
 1050              		.loc 1 174 16 is_stmt 1 view -0
 1051              		.cfi_startproc
 1052              		@ args = 0, pretend = 0, frame = 0
 1053              		@ frame_needed = 0, uses_anonymous_args = 0
 175:Thaumazein.cpp ****     InitializeSynth();
ARM GAS  /var/folders/9s/8rp0_f2s1n31qbztm3b5_fdh0000gn/T//cckLE3ug.s 			page 32


 1054              		.loc 1 175 5 view .LVU313
 174:Thaumazein.cpp ****     InitializeSynth();
 1055              		.loc 1 174 16 is_stmt 0 view .LVU314
 1056 0000 10B5     		push	{r4, lr}
 1057              		.cfi_def_cfa_offset 8
 1058              		.cfi_offset 4, -8
 1059              		.cfi_offset 14, -4
 1060              		.loc 1 175 20 view .LVU315
 1061 0002 FFF7FEFF 		bl	_Z15InitializeSynthv
 1062              	.LVL80:
 176:Thaumazein.cpp ****     // Check bootloader condition once at startup
 177:Thaumazein.cpp ****     Bootload();
 1063              		.loc 1 177 5 is_stmt 1 view .LVU316
 1064              		.loc 1 177 13 is_stmt 0 view .LVU317
 1065 0006 FFF7FEFF 		bl	_Z8Bootloadv
 1066              	.LVL81:
 178:Thaumazein.cpp ****     
 179:Thaumazein.cpp ****     uint32_t lastPoll = hw.system.GetNow();  // Track last poll time
 1067              		.loc 1 179 5 is_stmt 1 view .LVU318
 1068              		.loc 1 179 41 is_stmt 0 view .LVU319
 1069 000a FFF7FEFF 		bl	_ZN5daisy6System6GetNowEv
 1070              	.LVL82:
 1071 000e 0446     		mov	r4, r0
 1072              	.LVL83:
 1073              	.L50:
 180:Thaumazein.cpp ****     
 181:Thaumazein.cpp ****     // Main Loop 
 182:Thaumazein.cpp ****     while (1) {
 1074              		.loc 1 182 5 is_stmt 1 view .LVU320
 1075              	.LBB217:
 183:Thaumazein.cpp ****         UpdateLED();
 1076              		.loc 1 183 9 view .LVU321
 1077              		.loc 1 183 18 is_stmt 0 view .LVU322
 1078 0010 FFF7FEFF 		bl	_Z9UpdateLEDv
 1079              	.LVL84:
 184:Thaumazein.cpp ****         
 185:Thaumazein.cpp ****         // Check bootloader condition anytime during operation
 186:Thaumazein.cpp ****         Bootload();
 1080              		.loc 1 186 9 is_stmt 1 view .LVU323
 1081              		.loc 1 186 17 is_stmt 0 view .LVU324
 1082 0014 FFF7FEFF 		bl	_Z8Bootloadv
 1083              	.LVL85:
 187:Thaumazein.cpp ****         
 188:Thaumazein.cpp ****         // Heartbeat log every ~3 seconds
 189:Thaumazein.cpp ****         static uint32_t last_hb_time = 0;
 1084              		.loc 1 189 9 is_stmt 1 view .LVU325
 190:Thaumazein.cpp ****         uint32_t now = hw.system.GetNow();
 1085              		.loc 1 190 9 view .LVU326
 1086              		.loc 1 190 40 is_stmt 0 view .LVU327
 1087 0018 FFF7FEFF 		bl	_ZN5daisy6System6GetNowEv
 1088              	.LVL86:
 191:Thaumazein.cpp ****         if ((now - last_hb_time) >= 3000) {
 1089              		.loc 1 191 9 is_stmt 1 view .LVU328
 1090              		.loc 1 191 18 is_stmt 0 view .LVU329
 1091 001c 0D4A     		ldr	r2, .L51
 1092              		.loc 1 191 9 view .LVU330
 1093 001e 40F6B731 		movw	r1, #2999
ARM GAS  /var/folders/9s/8rp0_f2s1n31qbztm3b5_fdh0000gn/T//cckLE3ug.s 			page 33


 1094              		.loc 1 191 18 view .LVU331
 1095 0022 1368     		ldr	r3, [r2]
 1096 0024 C31A     		subs	r3, r0, r3
 1097              		.loc 1 191 9 view .LVU332
 1098 0026 8B42     		cmp	r3, r1
 1099 0028 03D9     		bls	.L48
 192:Thaumazein.cpp ****             last_hb_time = now;
 1100              		.loc 1 192 13 is_stmt 1 view .LVU333
 1101              		.loc 1 192 26 is_stmt 0 view .LVU334
 1102 002a 1060     		str	r0, [r2]
 193:Thaumazein.cpp ****             hw.PrintLine("HB");
 1103              		.loc 1 193 13 is_stmt 1 view .LVU335
 1104              	.LVL87:
 1105              	.LBB218:
 1106              	.LBI218:
 119:lib/libdaisy/src/daisy_seed.h ****     {
 1107              		.loc 3 119 17 view .LVU336
 1108              	.LBB219:
 1109              		.loc 3 121 23 is_stmt 0 view .LVU337
 1110 002c 0A48     		ldr	r0, .L51+4
 1111              	.LVL88:
 1112              		.loc 3 121 23 view .LVU338
 1113 002e FFF7FEFF 		bl	_ZN5daisy6LoggerILNS_17LoggerDestinationE1EE9PrintLineEPKcz
 1114              	.LVL89:
 1115              	.L48:
 1116              		.loc 3 121 23 view .LVU339
 1117              	.LBE219:
 1118              	.LBE218:
 194:Thaumazein.cpp ****         }
 195:Thaumazein.cpp ****         
 196:Thaumazein.cpp ****         UpdateDisplay();
 1119              		.loc 1 196 9 is_stmt 1 view .LVU340
 1120              		.loc 1 196 22 is_stmt 0 view .LVU341
 1121 0032 FFF7FEFF 		bl	_Z13UpdateDisplayv
 1122              	.LVL90:
 197:Thaumazein.cpp ****         
 198:Thaumazein.cpp ****         // Poll touch sensor every 5 ms (200 Hz)
 199:Thaumazein.cpp ****         if (hw.system.GetNow() - lastPoll >= 5) {
 1123              		.loc 1 199 9 is_stmt 1 view .LVU342
 1124              		.loc 1 199 29 is_stmt 0 view .LVU343
 1125 0036 FFF7FEFF 		bl	_ZN5daisy6System6GetNowEv
 1126              	.LVL91:
 1127              		.loc 1 199 32 view .LVU344
 1128 003a 001B     		subs	r0, r0, r4
 1129              		.loc 1 199 9 view .LVU345
 1130 003c 0428     		cmp	r0, #4
 1131 003e 04D9     		bls	.L49
 200:Thaumazein.cpp ****             lastPoll = hw.system.GetNow();
 1132              		.loc 1 200 13 is_stmt 1 view .LVU346
 1133              		.loc 1 200 40 is_stmt 0 view .LVU347
 1134 0040 FFF7FEFF 		bl	_ZN5daisy6System6GetNowEv
 1135              	.LVL92:
 1136 0044 0446     		mov	r4, r0
 1137              	.LVL93:
 201:Thaumazein.cpp ****             PollTouchSensor(); 
 1138              		.loc 1 201 13 is_stmt 1 view .LVU348
 1139              		.loc 1 201 28 is_stmt 0 view .LVU349
ARM GAS  /var/folders/9s/8rp0_f2s1n31qbztm3b5_fdh0000gn/T//cckLE3ug.s 			page 34


 1140 0046 FFF7FEFF 		bl	_Z15PollTouchSensorv
 1141              	.LVL94:
 1142              	.L49:
 202:Thaumazein.cpp ****         }
 203:Thaumazein.cpp ****         
 204:Thaumazein.cpp ****         // Yield for system tasks, adjusted for polling interval
 205:Thaumazein.cpp ****         System::Delay(1); // Shorter delay to allow more frequent polling checks
 1143              		.loc 1 205 9 is_stmt 1 view .LVU350
 1144              		.loc 1 205 22 is_stmt 0 view .LVU351
 1145 004a 0120     		movs	r0, #1
 1146 004c FFF7FEFF 		bl	_ZN5daisy6System5DelayEm
 1147              	.LVL95:
 1148              	.LBE217:
 182:Thaumazein.cpp ****         UpdateLED();
 1149              		.loc 1 182 5 is_stmt 1 view .LVU352
 206:Thaumazein.cpp ****     }
 1150              		.loc 1 206 5 is_stmt 0 view .LVU353
 1151 0050 DEE7     		b	.L50
 1152              	.L52:
 1153 0052 00BF     		.align	2
 1154              	.L51:
 1155 0054 00000000 		.word	.LANCHOR3
 1156 0058 00000000 		.word	.LC9
 1157              		.cfi_endproc
 1158              	.LFE5348:
 1160              		.global	touch_cv_value
 1161              		.global	current_touch_state
 1162              		.section	.rodata
 1163              		.set	.LANCHOR0,. + 0
 1164              	.LC0:
 1165 0000 01       		.byte	1
 1166 0001 08       		.byte	8
 1167              	.LC1:
 1168 0002 01       		.byte	1
 1169 0003 09       		.byte	9
 1170              		.section	.bss._ZZ4mainE12last_hb_time,"aw",%nobits
 1171              		.align	2
 1172              		.set	.LANCHOR3,. + 0
 1175              	_ZZ4mainE12last_hb_time:
 1176 0000 00000000 		.space	4
 1177              		.section	.bss.current_touch_state,"aw",%nobits
 1178              		.align	1
 1179              		.set	.LANCHOR1,. + 0
 1182              	current_touch_state:
 1183 0000 0000     		.space	2
 1184              		.section	.bss.touch_cv_value,"aw",%nobits
 1185              		.align	2
 1186              		.set	.LANCHOR2,. + 0
 1189              	touch_cv_value:
 1190 0000 00000000 		.space	4
 1191              		.text
 1192              	.Letext0:
 1193              		.file 7 "/Library/DaisyToolchain/0.2.0/arm/arm-none-eabi/include/machine/_default_types.h"
 1194              		.file 8 "/Library/DaisyToolchain/0.2.0/arm/arm-none-eabi/include/sys/_stdint.h"
 1195              		.file 9 "/Library/DaisyToolchain/0.2.0/arm/arm-none-eabi/include/stdint.h"
 1196              		.file 10 "/Library/DaisyToolchain/0.2.0/arm/lib/gcc/arm-none-eabi/10.3.1/include/stddef.h"
 1197              		.file 11 "/Library/DaisyToolchain/0.2.0/arm/arm-none-eabi/include/c++/10.3.1/cmath"
ARM GAS  /var/folders/9s/8rp0_f2s1n31qbztm3b5_fdh0000gn/T//cckLE3ug.s 			page 35


 1198              		.file 12 "/Library/DaisyToolchain/0.2.0/arm/arm-none-eabi/include/c++/10.3.1/bits/std_abs.h"
 1199              		.file 13 "/Library/DaisyToolchain/0.2.0/arm/arm-none-eabi/include/c++/10.3.1/cstdlib"
 1200              		.file 14 "/Library/DaisyToolchain/0.2.0/arm/arm-none-eabi/include/c++/10.3.1/cstdint"
 1201              		.file 15 "/Library/DaisyToolchain/0.2.0/arm/arm-none-eabi/include/c++/10.3.1/arm-none-eabi/thumb/v
 1202              		.file 16 "/Library/DaisyToolchain/0.2.0/arm/arm-none-eabi/include/c++/10.3.1/type_traits"
 1203              		.file 17 "/Library/DaisyToolchain/0.2.0/arm/arm-none-eabi/include/c++/10.3.1/debug/debug.h"
 1204              		.file 18 "/Library/DaisyToolchain/0.2.0/arm/arm-none-eabi/include/c++/10.3.1/bits/algorithmfwd.h"
 1205              		.file 19 "/Library/DaisyToolchain/0.2.0/arm/arm-none-eabi/include/c++/10.3.1/bits/stl_pair.h"
 1206              		.file 20 "/Library/DaisyToolchain/0.2.0/arm/arm-none-eabi/include/c++/10.3.1/bits/exception_ptr.h"
 1207              		.file 21 "/Library/DaisyToolchain/0.2.0/arm/arm-none-eabi/include/c++/10.3.1/cstdarg"
 1208              		.file 22 "/Library/DaisyToolchain/0.2.0/arm/arm-none-eabi/include/c++/10.3.1/cstdio"
 1209              		.file 23 "/Library/DaisyToolchain/0.2.0/arm/arm-none-eabi/include/c++/10.3.1/cstring"
 1210              		.file 24 "/Library/DaisyToolchain/0.2.0/arm/arm-none-eabi/include/c++/10.3.1/cwchar"
 1211              		.file 25 "/Library/DaisyToolchain/0.2.0/arm/arm-none-eabi/include/c++/10.3.1/clocale"
 1212              		.file 26 "/Library/DaisyToolchain/0.2.0/arm/arm-none-eabi/include/c++/10.3.1/bits/basic_string.h"
 1213              		.file 27 "/Library/DaisyToolchain/0.2.0/arm/arm-none-eabi/include/c++/10.3.1/bits/stl_iterator.h"
 1214              		.file 28 "/Library/DaisyToolchain/0.2.0/arm/arm-none-eabi/include/c++/10.3.1/bits/uses_allocator.h
 1215              		.file 29 "/Library/DaisyToolchain/0.2.0/arm/arm-none-eabi/include/c++/10.3.1/tuple"
 1216              		.file 30 "/Library/DaisyToolchain/0.2.0/arm/arm-none-eabi/include/c++/10.3.1/bits/std_function.h"
 1217              		.file 31 "/Library/DaisyToolchain/0.2.0/arm/arm-none-eabi/include/c++/10.3.1/functional"
 1218              		.file 32 "/Library/DaisyToolchain/0.2.0/arm/arm-none-eabi/include/c++/10.3.1/bits/stl_function.h"
 1219              		.file 33 "/Library/DaisyToolchain/0.2.0/arm/arm-none-eabi/include/c++/10.3.1/bits/refwrap.h"
 1220              		.file 34 "/Library/DaisyToolchain/0.2.0/arm/arm-none-eabi/include/c++/10.3.1/bits/predefined_ops.h
 1221              		.file 35 "/Library/DaisyToolchain/0.2.0/arm/arm-none-eabi/include/sys/_types.h"
 1222              		.file 36 "/Library/DaisyToolchain/0.2.0/arm/arm-none-eabi/include/sys/reent.h"
 1223              		.file 37 "/Library/DaisyToolchain/0.2.0/arm/arm-none-eabi/include/sys/lock.h"
 1224              		.file 38 "/Library/DaisyToolchain/0.2.0/arm/arm-none-eabi/include/math.h"
 1225              		.file 39 "/Library/DaisyToolchain/0.2.0/arm/arm-none-eabi/include/stdlib.h"
 1226              		.file 40 "/Library/DaisyToolchain/0.2.0/arm/arm-none-eabi/include/c++/10.3.1/math.h"
 1227              		.file 41 "/Library/DaisyToolchain/0.2.0/arm/arm-none-eabi/include/c++/10.3.1/stdlib.h"
 1228              		.file 42 "lib/libdaisy/src/daisy_core.h"
 1229              		.file 43 "lib/libdaisy/src/per/tim.h"
 1230              		.file 44 "lib/libdaisy/src/sys/system.h"
 1231              		.file 45 "lib/libdaisy/src/per/qspi.h"
 1232              		.file 46 "lib/libdaisy/src/per/dac.h"
 1233              		.file 47 "lib/libdaisy/src/per/sai.h"
 1234              		.file 48 "lib/libdaisy/src/hid/audio.h"
 1235              		.file 49 "lib/libdaisy/src/per/adc.h"
 1236              		.file 50 "lib/libdaisy/src/hid/usb.h"
 1237              		.file 51 "lib/libdaisy/src/hid/logger_impl.h"
 1238              		.file 52 "lib/libdaisy/src/util/wav_format.h"
 1239              		.file 53 "lib/libdaisy/src/hid/led.h"
 1240              		.file 54 "lib/libdaisy/src/hid/logger.h"
 1241              		.file 55 "lib/libdaisy/src/per/gpio.h"
 1242              		.file 56 "lib/libdaisy/src/dev/sdram.h"
 1243              		.file 57 "/Library/DaisyToolchain/0.2.0/arm/lib/gcc/arm-none-eabi/10.3.1/include/stdarg.h"
 1244              		.file 58 "/Library/DaisyToolchain/0.2.0/arm/arm-none-eabi/include/stdio.h"
 1245              		.file 59 "/Library/DaisyToolchain/0.2.0/arm/arm-none-eabi/include/string.h"
 1246              		.file 60 "lib/DaisySP/Source/Control/adenv.h"
 1247              		.file 61 "lib/DaisySP/Source/Utility/metro.h"
 1248              		.file 62 "/Library/DaisyToolchain/0.2.0/arm/arm-none-eabi/include/wchar.h"
 1249              		.file 63 "/Library/DaisyToolchain/0.2.0/arm/arm-none-eabi/include/locale.h"
 1250              		.file 64 "eurorack/stmlib/stmlib.h"
 1251              		.file 65 "eurorack/plaits/dsp/dsp.h"
 1252              		.file 66 "eurorack/plaits/dsp/engine/additive_engine.h"
 1253              		.file 67 "eurorack/plaits/dsp/oscillator/oscillator.h"
 1254              		.file 68 "eurorack/plaits/dsp/engine/chord_engine.h"
ARM GAS  /var/folders/9s/8rp0_f2s1n31qbztm3b5_fdh0000gn/T//cckLE3ug.s 			page 36


 1255              		.file 69 "eurorack/plaits/dsp/physical_modelling/resonator.h"
 1256              		.file 70 "eurorack/plaits/dsp/engine/particle_engine.h"
 1257              		.file 71 "eurorack/plaits/dsp/physical_modelling/string.h"
 1258              		.file 72 "eurorack/plaits/dsp/engine/string_engine.h"
 1259              		.file 73 "eurorack/plaits/dsp/engine/swarm_engine.h"
 1260              		.file 74 "eurorack/plaits/dsp/oscillator/variable_saw_oscillator.h"
 1261              		.file 75 "eurorack/plaits/dsp/voice.h"
 1262              		.file 76 "Effects/BiquadFilters.h"
 1263              		.file 77 "Arpeggiator.h"
 1264              		.file 78 "Thaumazein.h"
 1265              		.file 79 "lib/libdaisy/src/dev/sr_595.h"
 1266              		.file 80 "<built-in>"
ARM GAS  /var/folders/9s/8rp0_f2s1n31qbztm3b5_fdh0000gn/T//cckLE3ug.s 			page 37


DEFINED SYMBOLS
                            *ABS*:0000000000000000 Thaumazein.cpp
/var/folders/9s/8rp0_f2s1n31qbztm3b5_fdh0000gn/T//cckLE3ug.s:34     .text._Z13UpdateDisplayv:0000000000000000 $t
/var/folders/9s/8rp0_f2s1n31qbztm3b5_fdh0000gn/T//cckLE3ug.s:40     .text._Z13UpdateDisplayv:0000000000000000 _Z13UpdateDisplayv
/var/folders/9s/8rp0_f2s1n31qbztm3b5_fdh0000gn/T//cckLE3ug.s:283    .text._Z13UpdateDisplayv:00000000000000c8 $d
/var/folders/9s/8rp0_f2s1n31qbztm3b5_fdh0000gn/T//cckLE3ug.s:301    .text._Z15PollTouchSensorv:0000000000000000 $t
/var/folders/9s/8rp0_f2s1n31qbztm3b5_fdh0000gn/T//cckLE3ug.s:307    .text._Z15PollTouchSensorv:0000000000000000 _Z15PollTouchSensorv
/var/folders/9s/8rp0_f2s1n31qbztm3b5_fdh0000gn/T//cckLE3ug.s:1020   .text._Z15PollTouchSensorv:0000000000000234 $d
/var/folders/9s/8rp0_f2s1n31qbztm3b5_fdh0000gn/T//cckLE3ug.s:1042   .text.startup.main:0000000000000000 $t
/var/folders/9s/8rp0_f2s1n31qbztm3b5_fdh0000gn/T//cckLE3ug.s:1048   .text.startup.main:0000000000000000 main
/var/folders/9s/8rp0_f2s1n31qbztm3b5_fdh0000gn/T//cckLE3ug.s:1155   .text.startup.main:0000000000000054 $d
/var/folders/9s/8rp0_f2s1n31qbztm3b5_fdh0000gn/T//cckLE3ug.s:1189   .bss.touch_cv_value:0000000000000000 touch_cv_value
/var/folders/9s/8rp0_f2s1n31qbztm3b5_fdh0000gn/T//cckLE3ug.s:1182   .bss.current_touch_state:0000000000000000 current_touch_state
/var/folders/9s/8rp0_f2s1n31qbztm3b5_fdh0000gn/T//cckLE3ug.s:1171   .bss._ZZ4mainE12last_hb_time:0000000000000000 $d
/var/folders/9s/8rp0_f2s1n31qbztm3b5_fdh0000gn/T//cckLE3ug.s:1175   .bss._ZZ4mainE12last_hb_time:0000000000000000 _ZZ4mainE12last_hb_time
/var/folders/9s/8rp0_f2s1n31qbztm3b5_fdh0000gn/T//cckLE3ug.s:1178   .bss.current_touch_state:0000000000000000 $d
/var/folders/9s/8rp0_f2s1n31qbztm3b5_fdh0000gn/T//cckLE3ug.s:1185   .bss.touch_cv_value:0000000000000000 $d

UNDEFINED SYMBOLS
sprintf
_ZN5daisy6LoggerILNS_17LoggerDestinationE1EE9PrintLineEPKcz
update_display
cpu_meter
current_engine_index
smoothed_output_level
adc_raw_values
_ZNK6Mpr1218HasErrorEv
_ZN6Mpr12110ClearErrorEv
_ZN6Mpr1214InitERKNS_6ConfigE
_ZN6Mpr12113SetThresholdsEhh
_ZN6Mpr1217TouchedEv
_ZN5daisy6System6GetNowEv
_ZNK11Arpeggiator8IsActiveEv
_ZN5daisy3Led3SetEf
_ZN5daisy3Led6UpdateEv
_ZN6Mpr12120GetBaselineDeviationEh
touch_sensor
arp
pad_led_levels
arp_led_timestamps
ARP_LED_DURATION_MS
touch_leds
pad_led_prev_quant
_Z15InitializeSynthv
_Z8Bootloadv
_Z9UpdateLEDv
_ZN5daisy6System5DelayEm
